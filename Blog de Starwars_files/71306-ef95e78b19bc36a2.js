"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[71306],{17719:function(e,i,t){var n=t(50265),o=t(72125),r=t(49e3),l=t(15412),s=t(38256),a=t.n(s),d=t(26363),c=t(87488),u=t(5594);let getProjectStatusConfig=(e,i,t,n,o)=>{var r;let l={PENDING:{PENDING:{icon:{icon:i?"send-2":"longArrowRight",color:i?n.blueDefault:n.white,width:"20px"},text:o(t?"common:taskStatus.pending-subtasks":"common:taskStatus.send-project")}},DONE:{PENDING:{icon:{icon:"checked",color:n.yellowDefault,width:"20px",height:"20px"},text:o("common:taskStatus.update-project-delivery")},APPROVED:{icon:{icon:"verified",color:n.blueDefault,width:"20px"},text:o("common:taskStatus.project-approved")},REJECTED:{icon:{icon:"checked",color:n.danger,width:"20px"},text:o("common:taskStatus.update-project-delivery")}}};return(null===(r=l[null==e?void 0:e.task_status])||void 0===r?void 0:r[null==e?void 0:e.revision_status])||l.PENDING.PENDING},getCommonTaskStatusConfig=(e,i,t,n,o)=>{let r=i?n.blueDefault:n.white,l={DONE:{icon:{icon:"close",color:r,width:"12px"},text:o("common:taskStatus.mark-as-not-done")},PENDING:{icon:{icon:"checked2",color:t?n.gray["600"]:r,width:"14px"},text:o("common:taskStatus.mark-as-done")}};return l[null==e?void 0:e.task_status]||l.PENDING},getProjectIconConfig=(e,i,t)=>{var n;let o={DONE:{PENDING:i?{icon:"checked",color:t.yellowDefault,width:"27px",height:"27px"}:{icon:"verified",color:t.greenLight,width:"27px"},APPROVED:{icon:"verified",color:t.greenLight,width:"27px"},REJECTED:{icon:"checked",color:t.danger,width:"27px"}}};return(null===(n=o[null==e?void 0:e.task_status])||void 0===n?void 0:n[null==e?void 0:e.revision_status])||{icon:"unchecked",color:t.gray["300"],width:"27px"}},getCommonIconConfig=(e,i)=>{let t={DONE:{icon:"verified",color:i.greenLight,width:"27px"},PENDING:{icon:"unchecked",color:i.gray["300"],width:"27px"}};return t[null==e?void 0:e.task_status]||t.PENDING};function IconByTaskStatus(e){let{currentTask:i,noDeliveryFormat:t}=e,{hexColor:o}=(0,c.Z)();if((null==i?void 0:i.task_type)==="PROJECT"&&i.task_status){let e=getProjectIconConfig(i,!t,o);return(0,n.jsx)(u.Z,{...e})}let r=getCommonIconConfig(i,o);return(0,n.jsx)(u.Z,{...r})}let p=(0,d.forwardRef)((e,i)=>{let{currentTask:t,allowText:s,withTooltip:a,hasPendingSubtasks:d,noDeliveryFormat:p,buttonChildren:x,...g}=e,{backgroundColor:v}=(0,c.Z)(),h=function(e,i,t){let{t:n}=(0,l.Z)("dashboard"),{hexColor:o}=(0,c.Z)(),r=(null==e?void 0:e.revision_status)==="APPROVED";return(null==e?void 0:e.task_type)==="PROJECT"?getProjectStatusConfig(e,i,t,o,n):getCommonTaskStatusConfig(e,i,r,o,n)}(t,a,d);return a?(0,n.jsx)(o.u,{label:h.text,placement:"top",children:(0,n.jsx)(r.z,{ref:i,width:"40px",height:"40px",background:v,padding:"20px",borderRadius:"full",variant:"default",gridGap:"12px",_disabled:{bg:v,opacity:.6,cursor:"not-allowed",_hover:{bg:v}},_loading:{color:"blue.default"},...g,children:(0,n.jsx)(u.Z,{...h.icon})})}):s?(0,n.jsx)(r.z,{ref:i,display:"flex",minWidth:"26px",minHeight:"26px",background:"blue.default",lineHeight:"15px",padding:"12px 24px",borderRadius:"3px",variant:"default",textTransform:"uppercase",gridGap:"12px",_loading:{color:"blue.default"},...g,children:x||(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.Z,{...h.icon}),h.text]})}):(0,n.jsx)(r.z,{ref:i,className:"aaaaa",display:"flex",minWidth:"26px",minHeight:"26px",height:"fit-content",background:"none",lineHeight:"0",padding:"0",borderRadius:"30px",variant:"none",textTransform:"none",gridGap:"0",_loading:{color:"blue.default"},...g,children:(0,n.jsx)(IconByTaskStatus,{currentTask:t,noDeliveryFormat:p})})});p.displayName="ButtonVariants",i.Z=p,p.propTypes={currentTask:a().objectOf(a().oneOfType([a().any])),allowText:a().bool,withTooltip:a().bool,hasPendingSubtasks:a().bool,noDeliveryFormat:a().bool},p.defaultProps={currentTask:null,allowText:!1,withTooltip:!1,hasPendingSubtasks:void 0,noDeliveryFormat:!1}},16685:function(e,i,t){t.d(i,{Z:function(){return E}});var n=t(50265),o=t(55823),r=t(43015),l=t(18119),s=t(42072),a=t(38270),d=t(17855),c=t(52818),u=t(39531),p=t(38256),x=t.n(p),g=t(15412),v=t(17719),h=t(26363),m=t(30793),f=t(3597),b=t(49e3);function NoDeliveryFormat(e){let{currentTask:i,sendProject:t,closePopover:o,onClickHandler:r}=e,{t:l}=(0,g.Z)("dashboard"),[s,a]=(0,h.useState)(!1);return(0,n.jsxs)(m.xu,{display:"flex",flexDirection:"column",gridGap:"10px",children:[(0,n.jsx)(f.x,{size:"md",children:l("deliverProject.no-delivery-needed")}),(0,n.jsx)(b.z,{width:"fit-content",onClick:async()=>{a(!0),await t({task:i,taskStatus:"DONE",showShareModal:!r}),a(!1),o()},colorScheme:"blue",isLoading:s,type:"submit",children:l("deliverProject.handler-text")})]})}NoDeliveryFormat.propTypes={currentTask:x().objectOf(x().objectOf(x().any)),sendProject:x().func,closePopover:x().func,onClickHandler:x().func},NoDeliveryFormat.defaultProps={currentTask:{},sendProject:()=>{},closePopover:()=>{},onClickHandler:()=>{}};var j=t(75434),w=t(31826),k=t(90207),y=t(76392),_=t(56635),C=t(38006),S=t(551),R=t(53110);function UrlDeliveryFormat(e){let{currentAssetData:i,currentTask:t,sendProject:o,closePopover:r,onClickHandler:l,statusText:s}=e,{t:a}=(0,g.Z)("dashboard"),[d,c]=(0,h.useState)(!1),[u,p]=(0,h.useState)(!1),[x,v]=(0,h.useState)((null==t?void 0:t.github_url)||""),D=(0,j.ff)("gray.800","gray.350"),T=(0,j.ff)("gray.800","gray.350"),Z="string"==typeof(null==i?void 0:i.delivery_regex_url),F=S.object().shape({githubUrl:S.string().matches(null==i?void 0:i.delivery_regex_url,a("deliverProject.invalid-url",{url:null==i?void 0:i.delivery_regex_url})).required(a("deliverProject.url-is-required"))}),P=S.object().shape({githubUrl:S.string().matches(/https:\/\/github.com\//,a("deliverProject.invalid-url",{url:"https://github.com/"})).required(a("deliverProject.url-is-required"))});return(0,n.jsx)(C.J9,{initialValues:{githubUrl:(null==t?void 0:t.github_url)||""},onSubmit:async()=>{c(!0),""!==x&&(l&&await l(),await o({task:t,githubUrl:x,taskStatus:"DONE",showShareModal:!l}),c(!1),r())},validationSchema:Z?F:P,children:()=>{var e,t;return(0,n.jsxs)(C.l0,{style:{display:"flex",flexDirection:"column",gridGap:(null==i?void 0:null===(e=i.delivery_instructions)||void 0===e?void 0:e.length)?"0px":"14px"},children:[(0,n.jsx)(C.gN,{name:"githubUrl",children:e=>{let{field:i,form:t}=e;return v(t.values.githubUrl),(0,n.jsxs)(w.NI,{isInvalid:t.errors.githubUrl&&t.touched.githubUrl,children:[(0,n.jsx)(k.I,{...i,type:"text",id:"githubUrl",color:D,_focus:{color:T},placeholder:"https://..."}),(0,n.jsx)(y.J1,{marginTop:"10px",children:t.errors.githubUrl})]})}}),(0,n.jsx)(m.xu,{children:(null==i?void 0:null===(t=i.delivery_instructions)||void 0===t?void 0:t.length)>2?(0,n.jsx)(m.xu,{height:"100%",margin:"0 rem auto 0 auto",transition:"background 0.2s ease-in-out",borderRadius:"3px",maxWidth:"1280px",background:(0,j.ff)("white","dark"),width:{base:"100%",md:"auto"},className:"markdown-body ".concat((0,j.ff)("light","dark")),children:(0,n.jsx)(R.Z,{content:null==i?void 0:i.delivery_instructions})}):(0,n.jsx)(m.xu,{dangerouslySetInnerHTML:{__html:a("deliverProject.how-to-deliver-text",{link:"https://4geeksacademy.notion.site/How-to-deliver-a-project-e1db0a8b1e2e4fbda361fc2f5457c0de"})}})}),(0,n.jsx)(_.X,{my:"20px",size:"md",isChecked:u,onChange:()=>p(e=>!e),children:(0,n.jsx)(f.x,{fontSize:"sm",children:a("deliverProject.deliver-confirm")})}),(0,n.jsx)(b.z,{width:"fit-content",colorScheme:"blue",isLoading:d,type:"submit",isDisabled:!u,children:s||a("deliverProject.handler-text")})]})}})}UrlDeliveryFormat.propTypes={currentAssetData:x().objectOf(x().objectOf(x().any)),currentTask:x().objectOf(x().objectOf(x().any)),sendProject:x().func,closePopover:x().func,onClickHandler:x().func,statusText:x().string},UrlDeliveryFormat.defaultProps={currentAssetData:{},currentTask:{},sendProject:()=>{},closePopover:()=>{},onClickHandler:()=>{},statusText:""};var D=t(5594),T=t(87488),Z=t(58653),F=t(12509),P=t(26189),z=t(9269);function FileDeliveryFormat(e){var i,t;let{currentAssetData:o,currentTask:r,sendProject:l,closePopover:s,onClickHandler:a}=e,{t:d}=(0,g.Z)("dashboard"),[c,u]=(0,h.useState)(!1),[p,x]=(0,h.useState)(!1),[v,w]=(0,h.useState)(!1),[y,C]=(0,h.useState)([]),S=(0,h.useRef)(),O=(0,h.useRef)(null),{state:E}=(0,P.Z)(),{cohortSession:A}=E,{featuredColor:G,lightColor:I,modal:L,hexColor:N}=(0,T.Z)(),{createToast:W}=(0,z.Z)({toastId:"submit-project-error"}),H=y.some(e=>e.formatError)||y.some(e=>e.sizeError),B=y.reduce((e,i)=>{let{file:t}=i;return e+t.size},0),M=(null==o?void 0:o.delivery_formats)||"application/pdf,image/png,image/jpeg,image/jpg,image/gif,doc,docx",handleRemoveFileInList=e=>{let i=y.filter(i=>i.name!==e);C(i),S.current.removeAttribute("multiple"),S.current.value=null,S.current.setAttribute("multiple","multiple")},handleUploadFile=async()=>{x(!0);let e=new FormData;Array.from(y).forEach(i=>{let{file:t}=i;e.append("file",t)});let i=await F.Z.assignments({academy:null==A?void 0:A.academy.id}).uploadFile(r.id,e);if((null==i?void 0:i.status)<400){let e=i.data[0];x(!1),C([]),l({task:r,githubUrl:null==e?void 0:e.url,taskStatus:"DONE",showShareModal:!a}),W({position:"top",title:d("alert-message:files-uploaded"),status:"success",duration:4e3,isClosable:!0}),s()}else x(!1),W({position:"top",title:d("alert-message:something-went-wrong-with",{property:"Files"}),status:"error",duration:4e3,isClosable:!0})};return(0,n.jsxs)(m.xu,{children:[(null==o?void 0:null===(i=o.delivery_instructions)||void 0===i?void 0:i.length)>2?(0,n.jsx)(m.xu,{height:"100%",margin:"0 rem auto 0 auto",transition:"background 0.2s ease-in-out",borderRadius:"3px",maxWidth:"1280px",background:(0,j.ff)("white","dark"),width:{base:"100%",md:"auto"},className:"markdown-body ".concat((0,j.ff)("light","dark")),children:(0,n.jsx)(R.Z,{content:null==o?void 0:o.delivery_instructions})}):(0,n.jsxs)(f.x,{size:"md",children:[d("deliverProject.file-upload"),(0,n.jsx)("strong",{children:null==o?void 0:null===(t=o.delivery_formats)||void 0===t?void 0:t.replaceAll(",",", ").replaceAll(".","").toUpperCase()})]}),(0,n.jsxs)(m.xu,{className:"upload-wrapper ".concat(v&&"dragOver"),m:"10px 0",width:{base:"auto",md:"100%"},height:"86px",position:"relative",color:v?"blue.600":"blue.default",_hover:{color:"blue.default"},transition:"0.3s all ease-in-out",borderRadius:"12px",background:G,children:[(0,n.jsx)(m.xu,{width:"100%",height:"100%",position:"absolute",display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid currentColor",cursor:"pointer",borderWidth:"2px",borderRadius:"7px",children:(0,n.jsx)(m.xu,{className:"icon-bounce",children:(0,n.jsx)(D.Z,{icon:"upload",color:"currentColor",width:"24",height:"24"})})}),(0,n.jsx)(k.I,{type:"file",name:"Upload file",title:"",ref:S,onChange:e=>{w(!1);let i=e.target.files,t=M.replaceAll(".","").split(",");i.length>0&&Array.from(i).forEach(e=>{var i,n;let{type:o,name:r,size:l}=e,s=r.split(".").pop(),a=t.some(e=>String(o).includes(e)||s===e),d=!a,c=l>10485760;y.some(e=>e.name===r)||(C(i=>[...i,{name:r,type:o,size:l,file:e,formatError:d,sizeError:c}]),null===(n=O.current)||void 0===n||n.scrollTo({top:null===(i=O.current)||void 0===i?void 0:i.scrollHeight,behavior:"smooth"}),setTimeout(()=>{var e,i;null===(i=O.current)||void 0===i||i.scrollTo({top:null===(e=O.current)||void 0===e?void 0:e.scrollHeight,behavior:"smooth"})},[300]))})},accept:null==o?void 0:o.delivery_formats,placeholder:"Upload profile image",multiple:"multiple",position:"absolute",width:"100%",height:"100%",cursor:"pointer",opacity:"0",padding:"0",onDragOver:()=>w(!0),onDragLeave:()=>w(!1)})]}),(0,n.jsx)(_.X,{size:"md",mb:"10px",isChecked:c,onChange:()=>u(e=>!e),children:(0,n.jsx)(f.x,{fontSize:"sm",children:d("deliverProject.deliver-confirm")})}),y.some(e=>"string"==typeof(null==e?void 0:e.type))&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.xu,{ref:O,maxHeight:"300px",overflowY:"auto",children:y.map(e=>{let i=e.formatError||e.sizeError,t=e.name.split(".").pop(),o=["jpg","jpeg","png","gif","svg"].includes(t);return(0,n.jsxs)(m.xu,{display:"flex",my:"15px",p:"8px",border:"1px solid",borderColor:G,background:L.background,justifyContent:"space-between",alignItems:"center",borderRadius:"7px",children:[(0,n.jsxs)(m.xu,{display:"flex",gridGap:"9px",children:[(0,n.jsx)(D.Z,{icon:o?"image":"file",color:N.black,width:"32px",height:"41px"}),(0,n.jsxs)(m.xu,{position:"relative",children:[(0,n.jsx)(f.x,{size:"14px",style:{margin:"0px"},withLimit:e.name.length>20,children:e.name}),(0,n.jsx)(f.x,{size:"14px",style:{margin:"0px"},color:i&&N.danger,display:"flex",gridGap:"6px",children:i?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(D.Z,{icon:"warning",width:"13px",height:"13px",style:{marginTop:"5px"},color:"currentColor",full:!0,secondColor:N.white2}),e.formatError?d("deliverProject.error-file-format"):e.sizeError&&d("deliverProject.error-file-size")]}):(0,Z.td)(e.size)})]})]}),(0,n.jsx)(m.xu,{borderRadius:"20px",p:"7px",backgroundColor:"gray.500",onClick:()=>{handleRemoveFileInList(e.name)},cursor:"pointer",children:(0,n.jsx)(D.Z,{icon:"close",width:"10px",height:"10px",color:"#ffffff"})})]},e.name)})}),(0,n.jsx)(m.xu,{py:"12px",color:I,children:d("deliverProject.total-size",{size:(0,Z.td)(B)})})]}),(0,n.jsxs)(m.xu,{display:"flex",justifyContent:"space-evenly",mb:"6px",children:[(0,n.jsx)(b.z,{variant:"default",onClick:handleUploadFile,isLoading:p,isDisabled:!c||p||(null==y?void 0:y.length)===0||y.some(e=>"string"!=typeof(null==e?void 0:e.type))||H||B>10485760,textTransform:"uppercase",children:d("common:upload")}),(0,n.jsx)(b.z,{variant:"link",textTransform:"uppercase",onClick:s,children:d("common:cancel")})]})]})}FileDeliveryFormat.propTypes={currentAssetData:x().objectOf(x().objectOf(x().any)),currentTask:x().objectOf(x().objectOf(x().any)),sendProject:x().func,closePopover:x().func,onClickHandler:x().func},FileDeliveryFormat.defaultProps={currentAssetData:{},currentTask:{},sendProject:()=>{},closePopover:()=>{},onClickHandler:()=>{}};var O=t(88353);function FlagsDeliveryFormat(e){var i;let{currentAssetData:t,currentTask:o,sendProject:r,closePopover:l,onClickHandler:s,statusText:a}=e,{t:d}=(0,g.Z)("dashboard"),[c,u]=(0,h.useState)(!1),[p,x]=(0,h.useState)(!1),[v,j]=(0,h.useState)([]),[C,S]=(0,h.useState)([]),{createToast:R}=(0,z.Z)({toastId:"submit-flags-error"}),D=t.config||{},T=(null==D?void 0:null===(i=D.delivery)||void 0===i?void 0:i.quantity)||1,Z=[...Array(T).keys()];0===v.length&&(j(Array(T).fill("")),S(Array(T).fill("")));let handleFlagChange=(e,i)=>{let t=[...v];t[e]=i,j(t);let n=[...C];n[e]="",S(n)},checkForDuplicates=(e,i)=>{let t=[...i],n=e.map(e=>e.trim()).filter(e=>""!==e),o=new Set(n).size!==n.length;if(o){let i={};return e.forEach((e,t)=>{let n=e.trim();n&&(i[n]=(i[n]||[]).concat(t))}),Object.values(i).forEach(e=>{e.length>1&&e.forEach(e=>{t[e]=d("deliverProject.duplicate-flag")})}),{hasDuplicates:!0,errors:t}}return{hasDuplicates:!1,errors:t}},validateFlagFormat=e=>{let i=e.trim();return(i.startsWith("FLAG{")||i.startsWith("4GEEKS{"))&&i.endsWith("}")&&i.length>6},handleSubmit=async()=>{u(!0);let e=checkForDuplicates(v,C);if(e.hasDuplicates){S(e.errors),u(!1),R({position:"top",title:d("deliverProject.duplicate-flags-error"),status:"error",duration:4e3,isClosable:!0});return}let i=e.errors,t=!1;if(v.forEach((e,n)=>{let o=e.trim();o?validateFlagFormat(o)||(i[n]=d("deliverProject.invalid-flag-format"),t=!0):(i[n]=d("deliverProject.flag-required"),t=!0)}),S(i),t){R({position:"top",title:d("deliverProject.some-flags-invalid"),status:"error",duration:4e3,isClosable:!0}),u(!1);return}try{s&&await s(),await r({task:o,taskStatus:"DONE",flags:v.map(e=>e.trim()),showShareModal:!s}),l()}catch(e){R({position:"top",title:d("alert-message:something-went-wrong"),status:"error",duration:4e3,isClosable:!0})}u(!1)};return(0,n.jsxs)(m.xu,{children:[(0,n.jsx)(f.x,{size:"md",mb:4,children:d("deliverProject.submit-flags-instruction",{quantity:T})}),(0,n.jsx)(O.g,{spacing:3,align:"stretch",children:Z.map(e=>(0,n.jsxs)(w.NI,{isInvalid:!!C[e],children:[(0,n.jsx)(k.I,{placeholder:d("deliverProject.flag-placeholder"),value:v[e]||"",onChange:i=>handleFlagChange(e,i.target.value),size:"md"}),C[e]&&(0,n.jsx)(y.J1,{children:C[e]})]},e))}),(0,n.jsx)(_.X,{size:"md",mt:4,mb:4,isChecked:p,onChange:()=>x(e=>!e),children:(0,n.jsx)(f.x,{fontSize:"sm",children:d("deliverProject.deliver-confirm")})}),(0,n.jsx)(b.z,{width:"fit-content",colorScheme:"blue",isLoading:c,onClick:handleSubmit,isDisabled:!p||v.every(e=>!e.trim()),children:a||d("deliverProject.handler-text")})]})}function DeliveryFormat(e){let{currentAssetData:i,...t}=e,o=(null==i?void 0:i.delivery_formats)||"",r=(null==i?void 0:i.delivery_validation)||{};return o.includes("no_delivery")?(0,n.jsx)(NoDeliveryFormat,{...t,currentAssetData:i}):o.includes("url")?(0,n.jsx)(UrlDeliveryFormat,{...t,currentAssetData:i}):o.includes("flags")||r.flags?(0,n.jsx)(FlagsDeliveryFormat,{...t,currentAssetData:i}):(0,n.jsx)(FileDeliveryFormat,{...t,currentAssetData:i})}function ProjectSubmitButton(e){let{isGuidedExperience:i,isLoading:t,currentAssetData:p,currentTask:x,sendProject:h,onClickHandler:m,allowText:f,isPopoverOpen:b,closePopover:j,togglePopover:w,buttonChildren:k,portalled:y}=e,{t:_}=(0,g.Z)("dashboard"),C=f&&(null==x?void 0:x.revision_status)==="APPROVED",S=null===x||C,R=(e=>{switch(e){case"PENDING":return _("deliverProject.update-title");case"REJECTED":return _("deliverProject.resend-title");default:return _("deliverProject.title")}})(null==x?void 0:x.revision_status),D="string"==typeof(null==p?void 0:p.delivery_formats),T=D&&(null==p?void 0:p.delivery_formats.includes("no_delivery"));return(0,n.jsxs)(o.J,{id:"task-status",isOpen:b,onClose:()=>{j()},trigger:"click",placement:"top-start",children:[(0,n.jsx)(r.x,{children:(0,n.jsx)(v.Z,{isLoading:t,isDisabled:S,onClick:w,currentTask:x,noDeliveryFormat:T,allowText:f,buttonChildren:k,withTooltip:i})}),y?(0,n.jsx)(l.h,{children:(0,n.jsxs)(s.y,{children:[(0,n.jsx)(a.Q,{}),(0,n.jsx)(d.Y,{children:R}),(0,n.jsx)(c.u,{}),(0,n.jsx)(u.b,{children:(0,n.jsx)(DeliveryFormat,{currentAssetData:p,currentTask:x,sendProject:h,closePopover:j,onClickHandler:m,statusText:R})})]})}):(0,n.jsxs)(s.y,{children:[(0,n.jsx)(a.Q,{}),(0,n.jsx)(d.Y,{children:R}),(0,n.jsx)(c.u,{}),(0,n.jsx)(u.b,{children:(0,n.jsx)(DeliveryFormat,{currentAssetData:p,currentTask:x,sendProject:h,closePopover:j,onClickHandler:m,statusText:R})})]})]})}FlagsDeliveryFormat.propTypes={currentAssetData:x().objectOf(x().objectOf(x().any)),currentTask:x().objectOf(x().objectOf(x().any)),sendProject:x().func,closePopover:x().func,onClickHandler:x().func,statusText:x().string},FlagsDeliveryFormat.defaultProps={currentAssetData:{},currentTask:{},sendProject:()=>{},closePopover:()=>{},onClickHandler:()=>{},statusText:""},DeliveryFormat.propTypes={currentAssetData:x().objectOf(x().objectOf(x().any))},DeliveryFormat.defaultProps={currentAssetData:{}},ProjectSubmitButton.propTypes={isLoading:x().bool,currentAssetData:x().objectOf(x().oneOfType([x().any])),currentTask:x().objectOf(x().oneOfType([x().any])),sendProject:x().func,onClickHandler:x().func,closePopover:x().func,isPopoverOpen:x().bool,allowText:x().bool,togglePopover:x().func,buttonChildren:x().node,isGuidedExperience:x().bool,portalled:x().bool},ProjectSubmitButton.defaultProps={isLoading:!1,currentAssetData:{},currentTask:{},sendProject:()=>{},onClickHandler:()=>{},closePopover:()=>{},isPopoverOpen:!1,allowText:!1,togglePopover:()=>{},buttonChildren:null,isGuidedExperience:!1,portalled:!1};var E=ProjectSubmitButton},19016:function(e,i,t){var n=t(50265),o=t(49e3),r=t(15412),l=t(38256),s=t.n(l),a=t(26363),d=t(87488),c=t(5594),u=t(16685),p=t(26189),x=t(12509),g=t(17719),v=t(9269);function AssignmentButton(e){let{currentTask:i,sendProject:t,currentAssetData:l,allowText:s,onClickHandler:h,isGuidedExperience:m,hasPendingSubtasks:f,togglePendingSubtasks:b,setStage:j,portalled:w}=e,{t:k,lang:y}=(0,r.Z)("dashboard"),{hexColor:_}=(0,d.Z)(),{updateTaskReadAt:C,handleOpenReviewModal:S,changeStatusAssignment:R}=(0,p.Z)(),{createToast:D}=(0,v.Z)({toastId:"submit-assignment-error"}),[T,Z]=(0,a.useState)(l),[F,P]=(0,a.useState)(!1),[z,O]=(0,a.useState)(null);(0,a.useEffect)(()=>{(null==l?void 0:l.id)!==(null==T?void 0:T.id)&&Z(l)},[l]);let[E,A]=(0,a.useState)({isFetchingCommitFiles:!1,isOpeningReviewModal:!1,isChangingTaskStatus:!1}),G=s&&(null==i?void 0:i.revision_status)==="APPROVED",I=(null==i?void 0:i.revision_status)==="APPROVED"||(null==i?void 0:i.revision_status)==="REJECTED",L="string"==typeof(null==T?void 0:T.delivery_formats),N=L&&(null==T?void 0:T.delivery_formats.includes("no_delivery")),W=null===i||G,fetchAsset=async()=>{try{var e;let t=await x.Z.registry().getAsset(i.associated_slug);if((null==t?void 0:t.status)>=400)throw Error("Error fetching asset");let n=t.data;if(null==n?void 0:null===(e=n.translations)||void 0===e?void 0:e[y]){let e=await x.Z.registry().getAsset(t.data.translations[y]);n=e.data}return Z(n),n}catch(e){return console.error(e),D({position:"top",title:k("alert-message:something-went-wrong"),status:"error",duration:7e3,isClosable:!0}),null}},togglePopover=async()=>{T||await fetchAsset(),P(!F)},fetchFileData=async()=>{let e=T;if(e||(e=await fetchAsset()),"string"==typeof(null==e?void 0:e.delivery_formats)&&!(null==e?void 0:e.delivery_formats.includes("url"))){let e=await x.Z.assignments().getFile({id:i.id}),t=e.data;O(t)}},openAssignmentFeedbackModal=async()=>{if(i){var e;A(e=>({...e,isOpeningReviewModal:!0})),await C(i),j&&j("initial"),S({currentTask:i,externalFiles:z,cohortSlug:null===(e=i.cohort)||void 0===e?void 0:e.slug,defaultStage:"initial"}),A(e=>({...e,isOpeningReviewModal:!1}))}},loadAndOpenReviewModal=async()=>{A(e=>({...e,isOpeningReviewModal:!0})),await fetchFileData(),openAssignmentFeedbackModal()};return(null==i?void 0:i.task_type)==="PROJECT"?("DONE"===i.task_status||I)&&!m?(0,n.jsxs)(n.Fragment,{children:[(null==i?void 0:i.description)&&(0,n.jsx)(o.z,{variant:"none",onClick:loadAndOpenReviewModal,children:(0,n.jsx)(c.Z,{icon:"comment",color:_.blueDefault})}),(0,n.jsx)(g.Z,{isLoading:E.isOpeningReviewModal,onClick:loadAndOpenReviewModal,isDisabled:W,currentTask:i,hasPendingSubtasks:f,noDeliveryFormat:N,allowText:s})]}):f&&!I&&"PENDING"===i.task_status?(0,n.jsx)(g.Z,{isLoading:E.isOpeningReviewModal,allowText:s,onClick:b,isDisabled:W,currentTask:i,hasPendingSubtasks:f,withTooltip:m,noDeliveryFormat:N}):(0,n.jsx)(u.Z,{isGuidedExperience:m,currentAssetData:T,currentTask:i,sendProject:t,onClickHandler:h,allowText:s,isPopoverOpen:F,closePopover:()=>{P(!1)},togglePopover:togglePopover,portalled:w}):(0,n.jsx)(g.Z,{isLoading:E.isChangingTaskStatus,onClick:()=>{i&&(A(e=>({...e,isChangingTaskStatus:!0})),R(i).finally(()=>{A(e=>({...e,isChangingTaskStatus:!1})),h()}))},isDisabled:W,withTooltip:m,currentTask:i,hasPendingSubtasks:f,allowText:s})}i.Z=AssignmentButton,AssignmentButton.propTypes={currentTask:s().objectOf(s().oneOfType([s().any])),sendProject:s().func.isRequired,togglePendingSubtasks:s().func,allowText:s().bool,onClickHandler:s().func,currentAssetData:s().objectOf(s().oneOfType([s().any])),isGuidedExperience:s().bool,hasPendingSubtasks:s().bool,setStage:s().func,portalled:s().bool},AssignmentButton.defaultProps={currentTask:null,allowText:!1,onClickHandler:()=>{},currentAssetData:null,togglePendingSubtasks:()=>{},isGuidedExperience:!1,hasPendingSubtasks:void 0,setStage:null,portalled:!1}},46385:function(e,i,t){var n=t(50265),o=t(30793),r=t(73084),l=t(38256),s=t.n(l),a=t(87488);function LoaderScreen(e){let{width:i,height:t,objectFit:l,background:s,...d}=e,{backgroundColor:c}=(0,a.Z)();return(0,n.jsx)(o.xu,{display:"flex",alignItems:"center",position:"absolute",background:s||c,justifyContent:"center",width:"100%",height:"100%",style:{zIndex:50},top:"0px",left:"0px",...d,children:(0,n.jsx)(r.E,{src:"/static/images/loader.gif",width:i,height:t,objectFit:l,alt:"loader"})})}LoaderScreen.propTypes={width:s().string,height:s().string,objectFit:s().string,background:s().string},LoaderScreen.defaultProps={width:"200px",height:"200px",objectFit:"cover",background:void 0},i.Z=LoaderScreen},34571:function(e,i,t){var n=t(50265),o=t(59979),r=t(30793),l=t(49e3),s=t(38256),a=t.n(s),d=t(15412),c=t(87488),u=t(5594),p=t(24143);function CodeRevisionsList(e){let{codeRevisions:i,revisionContent:t,selectCodeRevision:s,...a}=e,{fontColor:x,borderColor:g,hexColor:v,featuredLight:h}=(0,c.Z)(),{t:m}=(0,d.Z)("assignments");return(0,n.jsx)(o.k,{overflow:"auto",height:"24rem",py:"0.5rem",flexDirection:"column",gridGap:"12px",...a,children:i.map(e=>{var i,a,d,c,f,b;let j=(null==t?void 0:t.id)===(null==e?void 0:e.id),w="boolean"==typeof(null==e?void 0:e.is_good),k={...e,revision_rating:null==e?void 0:e.revision_rating,hasBeenReviewed:w};return(0,n.jsxs)(o.k,{cursor:"pointer",onClick:()=>s(k),_hover:{background:h},border:"1px solid",borderColor:j?"blue.default":g,justifyContent:"space-between",alignItems:"center",height:"48px",padding:"4px 8px",borderRadius:"8px",children:[(0,n.jsxs)(o.k,{flex:.3,gridGap:"10px",children:[(0,n.jsx)(u.Z,{icon:"file2",width:"22px",height:"22px",display:"flex",alignItems:"center",color:x}),(0,n.jsxs)(o.k,{flexDirection:"column",justifyContent:"center",gridGap:"9px",maxWidth:"102px",children:[(0,n.jsxs)(o.k,{flexDirection:"column",gridGap:"0px",children:[(0,n.jsx)(p.Z,{fontSize:"12px",fontWeight:700,style:{textWrap:"nowrap",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:null==e?void 0:null===(i=e.file)||void 0===i?void 0:i.name}),(0,n.jsx)(p.Z,{fontSize:"12px",fontWeight:400,title:null==e?void 0:null===(a=e.file)||void 0===a?void 0:a.commit_hash,children:"".concat(null==e?void 0:null===(c=e.file)||void 0===c?void 0:null===(d=c.commit_hash)||void 0===d?void 0:d.slice(0,10),"...")})]}),(null==e?void 0:null===(f=e.committer)||void 0===f?void 0:f.github_username)&&(0,n.jsx)(r.xu,{fontSize:"12px",children:null==e?void 0:null===(b=e.committer)||void 0===b?void 0:b.github_username})]})]}),(0,n.jsx)(o.k,{flex:.3,justifyContent:"center",alignItems:"center",children:w?(0,n.jsx)(r.xu,{background:e.is_good?v.greenLight3:"red.light",borderRadius:"full",children:(0,n.jsx)(u.Z,{icon:"feedback-".concat(e.is_good?"like":"dislike"),width:"20px",height:"20px"})}):(0,n.jsxs)(o.k,{width:"auto",position:"relative",justifyContent:"center",children:[(0,n.jsx)(r.xu,{position:"absolute",top:-1.5,right:-2,background:"yellow.default",fontSize:"10px",padding:"3px",fontWeight:700,height:"auto",borderRadius:"50%",children:(0,n.jsx)(u.Z,{icon:"asterisk",width:"8px",height:"8px"})}),(0,n.jsx)(u.Z,{icon:"code-comment",width:"20px",height:"20px",color:v.black})]})}),(0,n.jsx)(l.z,{variant:"link",flex:.3,height:"40px",onClick:()=>s(k),display:"flex",width:"fit-content",justifyContent:"flex-end",alignItems:"center",padding:"0 1rem 0 0",gridGap:"10px",children:m("code-review.review")})]},e.id)})})}CodeRevisionsList.propTypes={selectCodeRevision:a().func,revisionContent:a().objectOf(a().oneOfType([a().any])),codeRevisions:a().arrayOf(a().oneOfType([a().any]))},CodeRevisionsList.defaultProps={selectCodeRevision:()=>{},revisionContent:null,codeRevisions:[]},i.Z=CodeRevisionsList},71306:function(e,i,t){t.d(i,{Z:function(){return ei},U:function(){return $}});var n=t(50265),o=t(38256),r=t.n(o),l=t(26363),s=t(59979),a=t(49e3),d=t(30793),c=t(67280),u=t(15412),p=t(26326),x=t(24143),g=t(87488),v=t(73424),h=t(18964),m=t(79784),f=t(5594),b=t(12509);t(99671),t(42083);var j=t(37623),w=t(53110),k=t(88141),y=t(22407),_=t(58653),C=t(84666),S=t(9269);let R={initial:"initial",started_revision:"started_revision",success:"success"};function CodeReview(e){var i,t,o,r;let{isExternal:p,onClose:D,disableRate:T,isStudent:Z,handleResetFlow:F,contextData:P,setContextData:z,setStage:O,selectedText:E,handleSelectedText:A}=e,{t:G}=(0,u.Z)("assignments"),[I,L]=(0,l.useState)({}),{user:N}=(0,C.Z)(),[W,H]=(0,l.useState)(R.initial),[B,M]=(0,l.useState)(!1),[U,q]=(0,l.useState)({code:"",comment:"",isSubmitting:!1}),{createToast:V}=(0,S.Z)({toastId:"code-review-error"}),{hexColor:J}=(0,g.Z)(),[X,K]=(0,l.useState)({status:null,comment:"",isSubmitting:!1,submited:!1,submitType:null}),Y=null==P?void 0:P.commitFile,$=null==P?void 0:P.revision_content,Q=void 0!==$,ee=null==X?void 0:X.status,ei=(null==P?void 0:P.my_revisions)||[],et=(null==P?void 0:P.code_revisions)||[],en=(null==P?void 0:P.translation)||{},eo=(null==$?void 0:null===(i=$.reviewer)||void 0===i?void 0:i.name)||(null==$?void 0:null===(t=$.reviewer)||void 0===t?void 0:t.username),resetView=()=>{K({status:null,comment:"",isSubmitting:!1,submited:!1,submitType:null}),z(e=>({...e,revision_content:void 0})),Z&&O("review_code_revision")},prepareCommitData=()=>{try{var e;let i=null==Y?void 0:null===(e=Y.path)||void 0===e?void 0:e.split(".").pop().replace(/\?.*$/,""),t=Y.code;L({raw:t,extensionLanguage:i,pathname:null==Y?void 0:Y.path,url:null==Y?void 0:Y.html_url,error:!1})}catch(e){console.error(e),L({msg:"No content found",error:!0})}};(0,l.useEffect)(()=>{prepareCommitData()},[Y]);let handleKeyUp=()=>{W===R.initial&&A()};(0,l.useEffect)(()=>(document.addEventListener("keyup",handleKeyUp),()=>{document.removeEventListener("keyup",handleKeyUp)}),[]);let goBack=()=>{p&&X.submited?D():(Z&&X.submited&&resetView(),Z&&null!==X.status&&K(e=>({...e,status:null,comment:""})),null===X.status&&(W===R.started_revision&&H(R.initial),W!==R.started_revision&&(Z?O("review_code_revision"):O("file_list"),q({code:"",comments:""}),F())))},handleSelectReviewRate=e=>{K(i=>({...i,status:e}))},onChangeRateComment=e=>{e.target.value.length<=100&&K(i=>({...i,comment:e.target.value}))},submitReviewRate=e=>{K(i=>({...i,isSubmitting:!0,submitType:e}));let i={send:{is_good:"like"===X.status,comment:X.comment},skip:{is_good:"like"===X.status,comment:null}};(0,y._1)({dataLayer:{event:"feedback_student_reaction",feedback_id:null==$?void 0:$.id,reaction:null==X?void 0:X.status,reaction_comment:"skip"===e?"":null==X?void 0:X.comment,repository:null==$?void 0:$.repository,user_id:N.id,agent:(0,_.S7)()}}),b.Z.assignments().rateCodeRevision(null==$?void 0:$.id,i[e]).then(e=>{let{data:i}=e;K(e=>({...e,submited:!0}));let t={...i,is_good:"string"==typeof(null==i?void 0:i.is_good)?(null==i?void 0:i.is_good)==="True":null==i?void 0:i.is_good,hasBeenReviewed:!0},n=et.map(e=>e.id===$.id?t:e);z(e=>({...e,code_revisions:n}))}).finally(()=>{K(e=>({...e,isSubmitting:!1}))})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.xu,{flex:.6,maxHeight:"76vh",overflow:"auto",onMouseUp:Z||W!==R.initial?()=>{}:A,children:(null==I?void 0:I.raw)?(0,n.jsx)(m.Z,{language:I.extensionLanguage,style:k.Z,customStyle:{margin:0,padding:"16px",background:"rgb(45, 45, 45)",border:"none",height:"100%",minWidth:"100%"},showLineNumbers:!1,wrapLines:!0,children:I.raw}):"Loading..."}),(0,n.jsx)(d.xu,{children:(0,n.jsx)(v.i,{orientation:"vertical"})}),(0,n.jsx)(d.xu,{maxWidth:Z?"455px":"",maxHeight:"76vh",overflow:"auto",flex:Z?.5:.4,children:W===R.success?(0,n.jsxs)(s.k,{flexDirection:"column",height:"100%",alignItems:"center",justifyContent:"center",gridGap:"24px",children:[(0,n.jsx)(x.Z,{size:"26px",fontWeight:700,textAlign:"center",lineHeight:"34px",children:G("code-review.code-review-successfully-sent")}),(0,n.jsx)(x.Z,{size:"18px",children:G("code-review.submited-assignments-count",{count:null==ei?void 0:ei.length})}),(0,n.jsxs)(a.z,{variant:"default",gridGap:"10px",mt:"10px",onClick:goBack,fontSize:"13px",fontWeight:700,textTransform:"uppercase",width:"100%",height:"48px",children:[(0,n.jsx)(f.Z,{icon:"code-comment",size:"23px",color:"#fff"}),(0,n.jsx)(x.Z,{children:G("code-review.start-other-code-review")})]})]}):(0,n.jsxs)(n.Fragment,{children:[W===R.initial&&!X.submited&&null!==ee&&(0,n.jsx)(d.xu,{mb:"1rem",children:(0,n.jsx)(f.Z,{"aria-label":"Go back",icon:"arrowLeft",width:"24px",height:"16px",color:J.black,onClick:goBack,cursor:"pointer"})}),(0,n.jsx)(j.Z,{size:"sm",mb:Z?"3rem":"24px",textAlign:Z&&"center",children:Z?G("code-review.teacher-has-reviewed-your-code",{name:eo}):G("code-review.code-review")}),(0,n.jsxs)(d.xu,{padding:"9px 0",borderRadius:"8px",overflow:"auto",children:[!Z&&(0,n.jsx)(x.Z,{fontSize:"14px",fontWeight:700,mb:"8px",children:G("code-review.reviewing")}),!Z&&(0,n.jsxs)(s.k,{gridGap:"10px",alignItems:"center",mb:"24px",children:[(0,n.jsx)(f.Z,{"aria-label":"Go back",icon:"arrowLeft",width:"17px",height:"11px",color:J.black,onClick:goBack,cursor:"pointer"}),(0,n.jsxs)(s.k,{alignItems:"center",width:"100%",gridGap:"9px",padding:"9px 8px",border:"1px solid",borderColor:J.borderColor,borderRadius:"8px",children:[(0,n.jsx)(f.Z,{icon:"folder",width:"14px",height:"14px",color:J.black}),(0,n.jsx)(d.xu,{minInlineSize:"max-content",children:I.pathname})]})]}),W===R.initial&&!Z&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.k,{gridGap:"15px",alignItems:"start",children:(null==E?void 0:E.length)>0?(0,n.jsx)(x.Z,{size:"14px",children:G("code-review.selection-code-text")}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.Z,{icon:"code-comment",size:"23px",color:J.blueDefault,mt:"5px"}),(0,n.jsx)(x.Z,{size:"18px",children:G("code-review.use-your-mouse-to-select-code")})]})}),(null==E?void 0:E.length)>0&&(0,n.jsxs)(d.xu,{fontSize:"13px",color:"#fff",mt:"2rem",padding:"6px 16px",borderRadius:"6px",whiteSpace:"pre-wrap",overflow:"auto",background:"rgb(45, 45, 45)",mb:"24px",children:[(0,n.jsx)(x.Z,{fontSize:"18px",color:"#fff",fontWeight:700,mb:"14px",children:G("code-review.you-selected-the-code")}),(0,n.jsx)(m.Z,{language:(null==Y?void 0:Y.language)||I.extensionLanguage,style:k.Z,customStyle:{padding:"16px",background:"rgb(45, 45, 45)",border:"none"},codeTagProps:{className:""},PreTag:"div",children:E.replace(/\n$/,"")})]}),E.length>0&&(0,n.jsxs)(a.z,{variant:"default",gridGap:"10px",onClick:()=>{let e=E.replace(/[^\t\n\r\x20-\x7E\x80-\xBF\xC0-\xFD\xFE\xFF]/g,""),i=btoa(e);q({code:i,comment:""}),H(R.started_revision)},fontSize:"13px",fontWeight:700,textTransform:"uppercase",width:"100%",height:"48px",children:[(0,n.jsx)(f.Z,{icon:"code-comment",size:"23px",color:"#fff"}),(0,n.jsx)(x.Z,{children:G("code-review.start-code-review")})]})]}),W===R.initial&&Z&&!X.submited&&(0,n.jsxs)(s.k,{flexDirection:"column",gridGap:"16px",children:[null===ee?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(w.Z,{content:null==$?void 0:$.comment}),(0,n.jsx)(d.xu,{fontSize:"13px",color:"#fff",padding:"6px 16px",borderRadius:"6px",whiteSpace:"pre-wrap",overflow:"auto",background:"rgb(45, 45, 45)",children:(0,n.jsx)(m.Z,{language:(null==$?void 0:$.language)||I.extensionLanguage,style:k.Z,customStyle:{padding:"16px",background:"rgb(45, 45, 45)",border:"none"},codeTagProps:{className:""},PreTag:"div",children:null==$?void 0:null===(o=$.code)||void 0===o?void 0:o.replace(/```+$/,"")})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.Z,{size:"14px",mb:"-6px",children:G("code-review.write-comment")}),(0,n.jsxs)(d.xu,{position:"relative",children:[(0,n.jsx)(c.g,{value:null==X?void 0:X.comment,"aria-label":"feedback input",fontSize:"14px",onChange:onChangeRateComment,minHeight:"130px",placeholder:"Start you review here..."}),(0,n.jsx)(d.xu,{position:"absolute",bottom:1.5,right:3,color:X.comment.length<10?"yellow.default":"currentColor",children:"".concat(X.comment.length,"/ ").concat(100)})]}),(0,n.jsxs)(s.k,{gridGap:"9px",mt:"0.7rem",children:[(0,n.jsx)(a.z,{flex:.7,variant:"default",isLoading:X.isSubmitting&&"send"===X.submitType,gridGap:"10px",isDisabled:X.comment.length<10,onClick:()=>submitReviewRate("send"),fontSize:"13px",fontWeight:700,textTransform:"uppercase",width:"100%",height:"48px",children:(0,n.jsx)(x.Z,{children:G("code-review.send")})}),(0,n.jsx)(a.z,{flex:.3,variant:"outline",isLoading:X.isSubmitting&&"skip"===X.submitType,borderColor:"blue.default",gridGap:"10px",onClick:()=>submitReviewRate("skip"),fontSize:"13px",fontWeight:700,textTransform:"uppercase",width:"100%",height:"48px",children:(0,n.jsx)(x.Z,{color:"blue.default",children:G("code-review.skip")})})]})]}),!T&&(0,n.jsxs)(s.k,{flexDirection:"column",gridGap:"24px",mt:"2rem",children:[!(null==$?void 0:$.hasBeenReviewed)&&(0,n.jsx)(n.Fragment,{children:ee?(0,n.jsx)(v.i,{margin:"18px 0 -8px 0"}):(0,n.jsx)(d.xu,{fontSize:"18px",textAlign:"center",children:G("code-review.did-feedback-useful")})}),(0,n.jsxs)(d.xu,{fontSize:"14px",textAlign:"center",children:[null===ee&&!(null==$?void 0:$.hasBeenReviewed)&&G("code-review.rate-comment"),("like"===ee||null===ee&&(null==$?void 0:$.is_good))&&G("code-review.you-liked-this-comment"),("dislike"===ee||null===ee&&!(null==$?void 0:$.is_good))&&G("code-review.you-disliked-this-comment")]}),(0,n.jsxs)(s.k,{justifyContent:"center",gridGap:"3.5rem",children:[(0,n.jsx)(a.z,{opacity:"dislike"!==ee&&(null==$?void 0:$.hasBeenReviewed)&&(null==$?void 0:$.is_good)||"like"===ee?1:.5,onClick:()=>handleSelectReviewRate("like"),variant:"unstyled",_hover:{opacity:1},height:"auto",gridGap:"10px","aria-label":"Mark as Useful",children:(0,n.jsx)(f.Z,{icon:"feedback-like",width:"54px",height:"54px"})}),(0,n.jsx)(a.z,{opacity:"like"!==ee&&(null==$?void 0:$.hasBeenReviewed)&&(null==$?void 0:$.is_good)===!1||"dislike"===ee?1:.5,onClick:()=>handleSelectReviewRate("dislike"),variant:"unstyled",_hover:{opacity:1},height:"auto",gridGap:"10px","aria-label":"Mark as not useful",children:(0,n.jsx)(f.Z,{icon:"feedback-dislike",width:"54px",height:"54px"})})]})]})]}),Q&&X.submited&&(0,n.jsxs)(s.k,{flexDirection:"column",gridGap:"16px",children:[(0,n.jsxs)(s.k,{flexDirection:"column",gridGap:"24px",borderRadius:"3px",alignItems:"center",background:"like"===ee?"green.light":"red.light2",padding:"16px 8px",children:[(0,n.jsx)(f.Z,{icon:"like"===ee?"feedback-like":"feedback-dislike",width:"60px",height:"60px"}),(0,n.jsx)(x.Z,{size:"14px",fontWeight:700,textAlign:"center",color:"black",children:G("code-review.comment-was-sent-successfully")})]}),(null==X?void 0:X.comment.length)>0&&(null==X?void 0:X.submitType)==="send"&&(0,n.jsx)(d.xu,{position:"relative",children:(0,n.jsx)(c.g,{readOnly:!0,opacity:.7,value:null==X?void 0:X.comment,"aria-label":"feedback input",fontSize:"12px",onChange:onChangeRateComment,minHeight:"130px",placeholder:""})}),(0,n.jsx)(a.z,{variant:"outline",borderColor:"blue.default",color:"blue.default",onClick:goBack,fontSize:"17px",gridGap:"15px",children:p?(null==en?void 0:null===(r=en.common)||void 0===r?void 0:r.close)||G("common:close"):G("code-review.back-to-comments")})]}),W===R.started_revision&&(0,n.jsxs)(s.k,{flexDirection:"column",gridGap:"24px",children:[(0,n.jsxs)(x.Z,{size:"14px",children:[G("code-review.code-review-started-msg")," ",(0,n.jsx)(h.r,{variant:"default",href:"/",fontSize:"14px",target:"_blank",rel:"noopener noreferer",children:G("code-review.here")}),"."]}),(0,n.jsxs)(d.xu,{position:"relative",children:[(0,n.jsx)(x.Z,{fontSize:"14px",fontWeight:700,mb:"18px",children:G("code-review.write-feedback-msg")}),(0,n.jsx)(c.g,{value:U.comment,"aria-label":"feedback input",fontSize:"12px",onChange:e=>{e.target.value.length<=380&&q(i=>({...i,comment:e.target.value}))},minHeight:"134",placeholder:"Start you review here..."}),(0,n.jsx)(d.xu,{position:"absolute",bottom:1.5,right:3,color:U.comment.length<10?"#EB5757":"currentColor",children:"".concat(U.comment.length,"/ ").concat(380)})]}),(0,n.jsxs)(a.z,{variant:"default",isLoading:B,gridGap:"10px",isDisabled:U.comment.length<10,onClick:()=>{var e,i,t;M(!0),(0,y._1)({dataLayer:{event:"submit_code_review",user_id:null==N?void 0:N.id,repository:null==Y?void 0:Y.repository,comment:U.comment,user_reviewed:{id:null==Y?void 0:null===(e=Y.committer)||void 0===e?void 0:e.id,username:null==Y?void 0:null===(i=Y.committer)||void 0===i?void 0:i.github_username,commitfile_id:null==Y?void 0:Y.id},agent:(0,_.S7)()}}),q(e=>({...e,isSubmitting:!0})),U.comment.length>=10&&b.Z.assignments().createCodeRevision(Y.task.id,{commitfile_id:null==Y?void 0:Y.id,content_for_review:U.code,comments:U.comment,github_username:null==Y?void 0:null===(t=Y.committer)||void 0===t?void 0:t.github_username}).then(e=>{var i;(null===(i=e.data.comment)||void 0===i?void 0:i.length)>0&&(z(i=>({...i,code_revisions:[...i.code_revisions,e.data],my_revisions:[...i.my_revisions,e.data]})),H(R.success))}).catch(e=>{V({title:G("alert-message:error-creating-code-review"),description:null==e?void 0:e.message,status:"error",duration:5e3,isClosable:!0})}).finally(()=>{q(e=>({...e,isSubmitting:!1}))})},fontSize:"13px",fontWeight:700,textTransform:"uppercase",width:"100%",height:"48px",children:[(0,n.jsx)(f.Z,{icon:"code-comment",size:"23px",color:U.comment.length<10?"#606060":"#fff"}),(0,n.jsx)(x.Z,{children:G("code-review.submit-code-review")})]})]})]})]})})]})}CodeReview.propTypes={setStage:r().func.isRequired,selectedText:r().string,handleSelectedText:r().func,contextData:r().objectOf(r().oneOfType([r().any])).isRequired,setContextData:r().func.isRequired,handleResetFlow:r().func.isRequired,isStudent:r().bool,disableRate:r().bool,isExternal:r().bool,onClose:r().func.isRequired},CodeReview.defaultProps={selectedText:"",handleSelectedText:()=>{},isStudent:!1,disableRate:!1,isExternal:!1};var D=t(75434),T=t(3597),Z=t(83505),F=t(90207),P=t(89896),z=t(11055),O=t(83268),E=t(8573),A=t(4775),G=t(29059),I=t(91810);function DeliverModalContent(e){var i,t;let{isStudent:o,currentTask:r,projectLink:c,updpateAssignment:p,deliveryUrl:x,onClose:v,readOnly:m,showCodeReviews:j,contextData:w,setStage:k,loaders:y,proceedToCommitFiles:_}=e,{t:C}=(0,u.Z)("assignments"),{modal:R,borderColor2:L,featuredColor:N,hexColor:W}=(0,g.Z)(),[H,B]=(0,l.useState)(!1),{createToast:M}=(0,S.Z)({toastId:" review-assignment-task-error"}),[U,q]=(0,l.useState)(!1),V=(0,l.useRef)(null),J="".concat(null==r?void 0:null===(i=r.user)||void 0===i?void 0:i.first_name," ").concat(null==r?void 0:null===(t=r.user)||void 0===t?void 0:t.last_name),X=(0,D.ff)("gra.dark","gray.250"),K=(0,D.ff)("gray.600","gray.200"),Y=(null==r?void 0:r.revision_status)==="IGNORED",$=(null==w?void 0:w.code_revisions)||[];return(0,l.useEffect)(()=>{U&&setTimeout(()=>{q(!1)},3e3)},[U]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(d.xu,{px:{base:"10px"},width:"100%",children:[(0,n.jsxs)(d.xu,{display:"flex",flexDirection:"column",pb:6,children:[(0,n.jsx)(T.x,{color:X,children:J}),(0,n.jsx)(h.r,{href:c,fontWeight:"700",letterSpacing:"0.05em",width:"fit-content",target:"_blank",rel:"noopener noreferrer",color:"blue.default",children:null==r?void 0:r.title})]}),(0,n.jsx)(Z.l,{fontSize:"12px",letterSpacing:"0.05em",color:K,children:C("deliver-assignment.label")}),(0,n.jsxs)(d.xu,{display:"flex",flexDirection:"row",children:[(0,n.jsx)(F.I,{ref:V,onClick:()=>{V.current.select(),navigator.clipboard.writeText(x),q(!0)},type:"text",background:(0,D.ff)("gray.250","featuredDark"),value:x,readOnly:!0,borderTopRightRadius:"0",borderBottomRightRadius:"0"}),(0,n.jsx)(a.z,{variant:"default",minWidth:"auto",background:U?"success":"blue.default",_hover:{background:U?"success":"blue.default"},onClick:()=>{!1===U&&(navigator.clipboard.writeText(x),q(!0))},borderTopLeftRadius:"0",borderBottomLeftRadius:"0",textTransform:"uppercase",fontSize:"13px",fontWeight:"700",p:"12px 16px",children:U?C("deliver-assignment.copied"):C("deliver-assignment.copy")})]}),(0,n.jsx)(T.x,{fontSize:"12px",letterSpacing:"0.05em",pt:"8px",color:K,children:C("deliver-assignment.hint")}),(null==r?void 0:r.description)&&(0,n.jsxs)(d.xu,{marginBottom:"10px",children:[(0,n.jsx)(T.x,{fontSize:"12px",letterSpacing:"0.05em",pt:"8px",color:K,children:C("deliver-assignment.feedback")}),(0,n.jsx)(T.x,{children:r.description})]}),j&&(0,n.jsxs)(s.k,{padding:"8px",flexDirection:"column",gridGap:"16px",background:N,borderRadius:"4px",children:[(0,n.jsxs)(s.k,{alignItems:"center",gridGap:"10px",children:[(0,n.jsx)(f.Z,{icon:"code",width:"18.5px",height:"17px",color:"currentColor"}),(0,n.jsx)(T.x,{size:"14px",fontWeight:700,children:C("code-review.count-code-reviews",{count:$.length||0})}),!o&&$.length>0&&(0,n.jsx)(a.z,{height:"auto",width:"fit-content",onClick:()=>k("review_code_revision"),isLoading:y.isFetchingCommitFiles,variant:"link",display:"flex",alignItems:"center",gridGap:"10px",justifyContent:"start",children:C("code-review.read-code-reviews")})]}),(0,n.jsxs)(a.z,{height:"auto",width:"fit-content",onClick:_,isLoading:y.isFetchingCommitFiles,variant:"link",display:"flex",alignItems:"center",gridGap:"10px",justifyContent:"start",children:[C("code-review.start-code-review"),(0,n.jsx)(f.Z,{icon:"longArrowRight",width:"24px",height:"10px",color:W.blueDefault})]})]}),!m&&(0,n.jsx)(P.m,{mt:"10px",paddingTop:"1.5rem",justifyContent:"center",borderTop:"1px solid",borderColor:L,children:(0,n.jsx)(a.z,{onClick:()=>B(!0),variant:Y?"default":"outline",textTransform:"uppercase",children:Y?C("deliver-assignment.mark-as-pending"):C("deliver-assignment.ignore-task")})})]}),(0,n.jsxs)(z.u_,{isOpen:H,onClose:()=>B(!1),size:"lg",children:[(0,n.jsx)(O.Z,{}),(0,n.jsxs)(E.h,{background:R.background2,borderRadius:"md",marginTop:"10%",children:[(0,n.jsx)(A.x,{fontSize:"15px",color:K,textAlign:"center",letterSpacing:"0.05em",borderBottom:"1px solid",borderColor:L,fontWeight:"bold",textTransform:"uppercase",children:C("deliver-assignment.title")}),(0,n.jsx)(G.o,{}),(0,n.jsx)(I.f,{pt:"2rem",pb:"2rem",px:{base:"20px",md:"15%"},children:(0,n.jsx)(T.x,{fontSize:"22px",fontWeight:"700",textAlign:"center",children:C("deliver-assignment.confirm-ignore",{student:J})})}),(0,n.jsx)(P.m,{margin:"0 1.5rem",padding:"1.5rem 0",justifyContent:"center",borderTop:"1px solid",borderColor:L,children:(0,n.jsx)(a.z,{onClick:()=>{b.Z.assignments().updateTask({id:r.id,revision_status:Y?"PENDING":"IGNORED"}).then(()=>{M({position:"top",title:C("alert-message:review-assignment-ignored-task"),status:"success",duration:5e3,isClosable:!0}),p({...r,id:r.id,revision_status:Y?"PENDING":"IGNORED"}),B(!1),v()}).catch(e=>{console.log(e),M({position:"top",title:C("alert-message:review-assignment-error"),status:"error",duration:5e3,isClosable:!0})})},variant:Y?"default":"outline",textTransform:"uppercase",children:Y?C("deliver-assignment.mark-as-pending"):C("deliver-assignment.ignore-task")})})]})]})]})}DeliverModalContent.propTypes={isStudent:r().bool,currentTask:r().objectOf(r().oneOfType([r().any])).isRequired,projectLink:r().string.isRequired,deliveryUrl:r().string.isRequired,readOnly:r().bool,updpateAssignment:r().func.isRequired,onClose:r().func.isRequired,showCodeReviews:r().bool,contextData:r().objectOf(r().oneOfType([r().any])),setStage:r().func,loaders:r().objectOf(r().oneOfType([r().any])),proceedToCommitFiles:r().func},DeliverModalContent.defaultProps={isStudent:!1,readOnly:!1,showCodeReviews:!1,contextData:{},setStage:()=>{},loaders:{},proceedToCommitFiles:()=>{}};var L=t(46729),N=t(91112);function FileList(e){var i;let{isStudent:t,currentTask:o,contextData:r,updpateAssignment:c,setContextData:p,stage:v,stages:h,setStage:m,setReviewStatus:b}=e,{t:w}=(0,u.Z)("assignments"),[k,y]=(0,l.useState)(!1),{fontColor:_,borderColor:C,lightColor:S,hexColor:R,featuredLight:D}=(0,g.Z)(),T=(null==r?void 0:r.commitFiles)||{},Z=(null==r?void 0:r.code_revisions)||[],F=(null==T?void 0:T.fileList)||[],P=null==o?void 0:o.revision_status,z="APPROVED"===P,O={approve:w("review-assignment.approve"),reject:w("review-assignment.reject")},E={approve:"success",reject:"danger"};(0,L.cM)("fileList:",F);let proceedToCodeReview=e=>{let i=null==e?void 0:e.content;p(t=>({...t,commitFile:{path:null==e?void 0:e.name,...e,task:(null==T?void 0:T.task)||{},code:i}})),m(h.code_review)},openCommitFile=e=>{proceedToCodeReview(e)};return(0,n.jsx)(s.k,{display:v!==h.file_list&&"none",flexDirection:"column",gridGap:"24px",width:"100%",children:(null==F?void 0:F.length)>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.k,{mb:"15px",gridGap:"2px",flexDirection:"column",children:[(0,n.jsx)(j.Z,{size:"18px",color:S,fontWeight:400,children:w("code-review.select-file-to-review")}),(0,n.jsx)(j.Z,{size:"18px",fontWeight:700,children:null==T?void 0:null===(i=T.task)||void 0===i?void 0:i.title})]}),(0,n.jsxs)(s.k,{my:"10px",py:"10px",px:"10px",borderRadius:"10px",background:D,children:[(0,n.jsx)(d.xu,{fontSize:"12px",flex:.33,children:w("code-review.filename")}),(0,n.jsx)(d.xu,{fontSize:"12px",flex:.33,children:w("code-review.feedback-status")}),(0,n.jsx)(d.xu,{fontSize:"12px",flex:.33,children:w("code-review.reviews")})]}),(0,n.jsx)(s.k,{flexDirection:"column",gridGap:"12px",children:F.map(e=>{var i,t;let o=(null==Z?void 0:Z.length)>0?Z.filter(i=>{var t;return(null==i?void 0:null===(t=i.file)||void 0===t?void 0:t.id)===(null==e?void 0:e.id)}).sort((e,i)=>new Date(i.updated_at)-new Date(e.updated_at)):[],r=(null==o?void 0:o[0])||{},l="boolean"==typeof(null==r?void 0:r.is_good),c=(null==r?void 0:r.is_good)?"feedback-like":"feedback-dislike";return(0,n.jsxs)(s.k,{border:"1px solid",borderColor:C,justifyContent:"center",alignItems:"center",minHeight:"48px",padding:"4px 8px",borderRadius:"8px",children:[(0,n.jsx)(f.Z,{icon:"file2",width:"22px",height:"22px",display:"flex",alignItems:"center",color:_,flex:.1}),(0,n.jsxs)(s.k,{flexDirection:"column",flex:.4,maxWidth:"102px",children:[(0,n.jsxs)(s.k,{flexDirection:"column",gridGap:"0px",children:[(0,n.jsx)(x.Z,{fontSize:"12px",fontWeight:700,style:{textWrap:"nowrap"},children:null==e?void 0:e.name}),(0,n.jsx)(x.Z,{fontSize:"12px",fontWeight:400,title:null==e?void 0:e.commit_hash,children:"".concat(null==e?void 0:e.commit_hash.slice(0,10),"...")})]}),(null==e?void 0:null===(i=e.committer)||void 0===i?void 0:i.github_username)&&(0,n.jsx)(d.xu,{fontSize:"12px",children:null==e?void 0:null===(t=e.committer)||void 0===t?void 0:t.github_username})]}),(0,n.jsx)(s.k,{flex:.3,alignItems:"center",justifyContent:"center",opacity:null!==r.is_good?1:.5,children:(0,n.jsx)(f.Z,{icon:l&&null!==r.is_good?c:"unchecked",width:"24px",height:"24px"})}),(0,n.jsx)(s.k,{flex:.3,justifyContent:"center",alignItems:"center",children:(0,n.jsxs)(s.k,{width:"auto",position:"relative",justifyContent:"center",children:[(0,n.jsx)(d.xu,{position:"absolute",top:-1.5,right:-2,background:"blue.default",fontSize:"10px",padding:"1px 5px",fontWeight:700,height:"auto",borderRadius:"50%",children:(null==o?void 0:o.length)||0}),(0,n.jsx)(f.Z,{icon:"code-comment",width:"20px",height:"20px",color:R.black})]})}),(0,n.jsx)(a.z,{variant:"default",isDisabled:!(null==e?void 0:e.content),flex:.2,height:"40px",onClick:()=>{(null==e?void 0:e.content)&&openCommitFile(e)},display:"flex",alignItems:"center",gridGap:"10px",children:w("code-review.start-review")})]})})})]}):(0,n.jsxs)(s.k,{alignItems:"center",justifyContent:"center",padding:"0 0 1.5rem 0",height:"100%",width:"500px",flexDirection:"column",margin:"1rem auto",gridGap:"0.7rem",children:[(0,n.jsx)(j.Z,{size:"xsm",children:w("code-review.no-files-to-review")}),(0,n.jsx)(x.Z,{size:"14px",textAlign:"center",style:{textWrap:"balance"},children:z?w("code-review.student-has-no-files-but-has-been-approved"):w("code-review.student-has-no-files-to-review")}),!z&&(0,n.jsx)(s.k,{width:"100%",justifyContent:"space-between",mt:"3rem",children:["reject","approve"].map(e=>(0,n.jsx)(a.z,{minWidth:"128px",background:E[e],_hover:{background:E[e]},onClick:()=>{m(h.approve_or_reject_code_revision),b(e)},color:"white",borderRadius:"3px",fontSize:"13px",textTransform:"uppercase",children:O[e]}))}),!t&&z&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.z,{minWidth:"128px",mt:"8px",onClick:()=>y(!0),color:"currentColor",borderRadius:"3px",fontSize:"13px",textTransform:"uppercase",variant:"outline",width:"fit-content",alignSelf:"center",children:w("task-handler.undo-approval")}),(0,n.jsx)(N.Z,{isOpen:k,onClose:()=>y(!1),updpateAssignment:c,currentTask:o})]})]})})}FileList.propTypes={stage:r().string,stages:r().shape({initial:r().string,file_list:r().string,code_review:r().string,approve_or_reject_code_revision:r().string}),setStage:r().func,contextData:r().arrayOf(r().oneOfType([r().any])).isRequired,setContextData:r().func,setReviewStatus:r().func.isRequired,isStudent:r().bool.isRequired,updpateAssignment:r().func,currentTask:r().objectOf(r().oneOfType([r().any])).isRequired},FileList.defaultProps={stage:"",stages:{initial:"initial",file_list:"file_list",code_review:"code_review"},setStage:()=>{},setContextData:()=>{},updpateAssignment:()=>{}};var W=t(34571);let H={status:null,comment:"",isSubmitting:!1,submited:!1,submitType:null,revision_rating:null};function ReviewCodeRevision(e){var i,t,o,r;let{contextData:p,setContextData:h,stages:m,setStage:k,disableRate:y}=e,{lightColor:_,hexColor:C,featuredLight:S}=(0,g.Z)(),[R,D]=(0,l.useState)(H),{t:T}=(0,u.Z)("assignments"),Z=null==R?void 0:R.status,F=(null==p?void 0:p.commitFiles)||{},P=(null==p?void 0:p.commitFile)||{},z=(null==p?void 0:p.code_revisions)||[],O=null==p?void 0:p.revision_content,E=void 0!==O,resetView=()=>{D({status:null,comment:"",isSubmitting:!1,submited:!1,submitType:null})},selectCodeRevision=function(e){var i;let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=null==e?void 0:e.original_code,o=(null==F?void 0:null===(i=F.fileList)||void 0===i?void 0:i.length)>0?F.fileList.find(i=>{var t;return i.id===(null==e?void 0:null===(t=e.file)||void 0===t?void 0:t.id)}):{},r=atob(n);t&&D(H),h(i=>{var t;return{...i,commitFile:{...o,task:(null==F?void 0:F.task)||{},code:null==o?void 0:o.content},revision_content:{path:null==e?void 0:null===(t=e.file)||void 0===t?void 0:t.name,...e,task:(null==F?void 0:F.task)||{},code:r}}})};(0,l.useEffect)(()=>{if((null==z?void 0:z.length)>0&&!(null==O?void 0:O.id)){let e=(null==z?void 0:z[0])||{},i=(null==e?void 0:e.revision_rating)>0||(null==e?void 0:e.revision_rating)!==null;selectCodeRevision({...e,revision_rating:null==e?void 0:e.revision_rating,hasBeenReviewed:i})}},[z,O]);let handleSelectReviewRate=e=>{D(i=>({...i,status:e}))},onChangeRateComment=e=>{e.target.value.length<=100&&D(i=>({...i,comment:e.target.value}))},submitReviewRate=e=>{D(i=>({...i,isSubmitting:!0,submitType:e}));let i={send:{is_good:"like"===R.status,comment:R.comment},skip:{is_good:"like"===R.status,comment:null}};b.Z.assignments().rateCodeRevision(null==O?void 0:O.id,i[e]).then(e=>{let{data:i}=e;D(e=>({...e,submited:!0}));let t={...i,is_good:"string"==typeof(null==i?void 0:i.is_good)?(null==i?void 0:i.is_good)==="True":null==i?void 0:i.is_good,hasBeenReviewed:!0},n=z.map(e=>e.id===O.id?t:e);selectCodeRevision(t,!1),h(e=>({...e,code_revisions:n}))}).finally(()=>{D(e=>({...e,isSubmitting:!1}))})};return(0,n.jsx)(s.k,{flexDirection:"row",height:"30rem",justifyContent:"center",gridGap:"6px",width:"100%",maxHeight:Z?"auto":"30rem",children:(null==z?void 0:z.length)>0?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(d.xu,{width:"100%",flex:.65,children:[(0,n.jsxs)(s.k,{mb:"15px",gridGap:"2px",flexDirection:"column",children:[(0,n.jsx)(j.Z,{size:"18px",color:_,fontWeight:400,children:T("code-review.select-file-to-review")}),(0,n.jsx)(j.Z,{size:"18px",fontWeight:700,children:null==F?void 0:null===(i=F.task)||void 0===i?void 0:i.title})]}),(0,n.jsxs)(s.k,{my:"10px",py:"10px",px:"10px",borderRadius:"10px",background:S,children:[(0,n.jsx)(d.xu,{fontSize:"12px",flex:.33,children:T("code-review.filename")}),(0,n.jsx)(d.xu,{fontSize:"12px",flex:.33,textAlign:"center",children:T("code-review.feedback-status")})]}),(0,n.jsx)(W.Z,{codeRevisions:z,revisionContent:O,selectCodeRevision:selectCodeRevision})]}),(null==O?void 0:O.id)&&(0,n.jsxs)(s.k,{flexDirection:"column",overflow:"auto",gridGap:"12px",flex:.35,width:"100%",padding:"8px",mt:!E&&"3.4rem",children:[(0,n.jsx)(d.xu,{fontSize:"14px",fontWeight:700,letterSpacing:"0.08em",children:null==O?void 0:null===(t=O.file)||void 0===t?void 0:t.name}),(0,n.jsx)(v.i,{}),E&&!R.submited&&(0,n.jsxs)(s.k,{flexDirection:"column",gridGap:"16px",children:[null===Z?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.k,{flexDirection:"column",gridGap:"8px",children:[(0,n.jsx)(j.Z,{fontSize:"12px",fontWeight:700,children:T("code-review.person-has-commented",{name:null==O?void 0:null===(o=O.reviewer)||void 0===o?void 0:o.name})}),(0,n.jsx)(x.Z,{size:"12px",children:null==O?void 0:O.comment}),(0,n.jsx)(d.xu,{fontSize:"13px",color:"#fff",borderRadius:"6px",whiteSpace:"pre-wrap",overflow:"auto",children:(0,n.jsx)(w.Z,{content:"```".concat((null==O?void 0:null===(r=O.file)||void 0===r?void 0:r.language)||"bash","\n").concat(null==O?void 0:O.code,"\n```")})})]}),(0,n.jsxs)(a.z,{isDisabled:null==P?void 0:P.id,onClick:()=>k(m.code_review),color:(null==P?void 0:P.id)&&"white",variant:"link",fontSize:"17px",gridGap:"15px",children:[(null==P?void 0:P.id)&&(0,n.jsx)(f.Z,{icon:"longArrowRight",width:"20px",height:"20px",color:C.blueDefault}),(null==P?void 0:P.id)?T("code-review.go-to-review"):"No commit file found"]}),(0,n.jsx)(v.i,{mt:"-8px"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.Z,{size:"14px",mb:"-6px",children:T("code-review.write-comment")}),(0,n.jsxs)(d.xu,{position:"relative",children:[(0,n.jsx)(c.g,{value:null==R?void 0:R.comment,"aria-label":"feedback input",fontSize:"12px",onChange:onChangeRateComment,minHeight:"130px",placeholder:T("code-review.start-review-here")}),(0,n.jsx)(d.xu,{position:"absolute",bottom:1.5,right:3,color:R.comment.length<10?"yellow.default":"currentColor",children:"".concat(R.comment.length,"/ ").concat(100)})]}),(0,n.jsxs)(s.k,{gridGap:"9px",mt:"0.7rem",children:[(0,n.jsx)(a.z,{flex:.7,variant:"default",isLoading:R.isSubmitting&&"send"===R.submitType,gridGap:"10px",isDisabled:R.comment.length<10,onClick:()=>submitReviewRate("send"),fontSize:"13px",fontWeight:700,textTransform:"uppercase",width:"100%",height:"48px",children:(0,n.jsx)(x.Z,{children:T("code-review.send")})}),(0,n.jsx)(a.z,{flex:.3,variant:"outline",isLoading:R.isSubmitting&&"skip"===R.submitType,borderColor:"blue.default",gridGap:"10px",onClick:()=>submitReviewRate("skip"),fontSize:"13px",fontWeight:700,textTransform:"uppercase",width:"100%",height:"48px",children:(0,n.jsx)(x.Z,{color:"blue.default",children:T("code-review.skip")})})]})]}),!y&&(0,n.jsxs)(s.k,{flexDirection:"column",gridGap:"24px",children:[Z&&(0,n.jsx)(v.i,{margin:"18px 0 -8px 0"}),(0,n.jsxs)(d.xu,{fontSize:"14px",textAlign:"center",children:[null===Z&&!(null==O?void 0:O.hasBeenReviewed)&&T("code-review.rate-comment"),("like"===Z||null===Z&&(null==O?void 0:O.is_good))&&T("code-review.you-liked-this-comment"),("dislike"===Z||null===Z&&!(null==O?void 0:O.is_good))&&T("code-review.you-disliked-this-comment")]}),(0,n.jsxs)(s.k,{justifyContent:"center",gridGap:"3.5rem",children:[(0,n.jsx)(a.z,{opacity:"dislike"!==Z&&(null==O?void 0:O.hasBeenReviewed)&&(null==O?void 0:O.is_good)||"like"===Z?1:.5,onClick:()=>handleSelectReviewRate("like"),variant:"unstyled",height:"auto",gridGap:"10px","aria-label":"Mark as Useful",_hover:{opacity:1},children:(0,n.jsx)(f.Z,{icon:"feedback-like",width:"54px",height:"54px"})}),(0,n.jsx)(a.z,{opacity:"like"!==Z&&(null==O?void 0:O.hasBeenReviewed)&&(null==O?void 0:O.is_good)===!1||"dislike"===Z?1:.5,onClick:()=>handleSelectReviewRate("dislike"),variant:"unstyled",height:"auto",gridGap:"10px","aria-label":"Mark as not useful",_hover:{opacity:1},children:(0,n.jsx)(f.Z,{icon:"feedback-dislike",width:"54px",height:"54px"})})]})]})]}),E&&R.submited&&(0,n.jsxs)(s.k,{flexDirection:"column",gridGap:"16px",children:[(0,n.jsxs)(s.k,{flexDirection:"column",gridGap:"24px",borderRadius:"3px",alignItems:"center",background:"like"===Z?"green.light":"red.light2",padding:"16px 8px",children:[(0,n.jsx)(f.Z,{icon:"like"===Z?"feedback-like":"feedback-dislike",width:"60px",height:"60px"}),(0,n.jsx)(x.Z,{size:"14px",fontWeight:700,textAlign:"center",color:"black",children:T("code-review.comment-was-sent-successfully")})]}),(null==R?void 0:R.comment.length)>0&&(null==R?void 0:R.submitType)==="send"&&(0,n.jsx)(d.xu,{position:"relative",children:(0,n.jsx)(c.g,{readOnly:!0,opacity:.7,value:null==R?void 0:R.comment,"aria-label":"feedback input",fontSize:"12px",onChange:onChangeRateComment,minHeight:"130px",placeholder:""})}),(0,n.jsx)(a.z,{variant:"outline",borderColor:"blue.default",color:"blue.default",onClick:()=>{R.submited&&resetView(),null!==R.status?D(e=>({...e,status:null,comment:""})):h(e=>({...e,revision_content:void 0}))},fontSize:"17px",gridGap:"15px",children:T("code-review.back-to-comments")})]})]})]}):(0,n.jsxs)(s.k,{alignItems:"center",flexDirection:"column",my:"4rem",gridGap:"0.7rem",children:[(0,n.jsx)(j.Z,{size:"xsm",children:T("code-review.no-files-to-review")}),(0,n.jsx)(x.Z,{size:"14px",children:T("code-review.teacher-has-not-reviewed-files")})]})})}ReviewCodeRevision.propTypes={stages:r().shape({initial:r().string,file_list:r().string,code_review:r().string,review_code_revision:r().string}),setStage:r().func,contextData:r().arrayOf(r().oneOfType([r().any])).isRequired,setContextData:r().func,disableRate:r().bool},ReviewCodeRevision.defaultProps={stages:{initial:"initial",file_list:"file_list",code_review:"code_review",review_code_revision:"review_code_revision"},setStage:()=>{},setContextData:()=>{},disableRate:!1};var B=t(59284),M=t(26189),U=t(46385),q=t(16685),V=t(77522);let{APPROVED:J,PENDING:X,REJECTED:K}={PENDING:"PENDING",APPROVED:"APPROVED",REJECTED:"REJECTED"};function AssignmentReview(e){var i,t,o;let{currentTask:r,loaders:c,hasFilesToReview:p,isStudent:v,noFilesToReview:m,disableRate:j,contextData:w,setStage:k,rejectOrApprove:y,updpateAssignment:_,onClose:R,resetState:D,setLoaders:T,externalFiles:Z}=e,{t:F}=(0,u.Z)("assignments"),{createToast:P}=(0,S.Z)({toastId:" review-status-code-revisions"}),{lightColor:z,featuredColor:O}=(0,g.Z)(),[E,A]=(0,l.useState)(!1),[G,I]=(0,l.useState)(!1),[W,H]=(0,l.useState)(null),[Y,$]=(0,l.useState)(),{isAuthenticatedWithRigobot:Q}=(0,C.Z)(),{cohortSession:ee,updateAssignment:ei,changeStatusAssignment:et}=(0,M.Z)(),en=(null==w?void 0:w.commitFiles)||{},eo=(null==w?void 0:w.code_revisions)||[],er=null==r?void 0:r.task_status,el=null==r?void 0:r.revision_status,es=el===X,ea=el===J,ed="".concat(null==r?void 0:null===(i=r.user)||void 0===i?void 0:i.first_name," ").concat(null==r?void 0:null===(t=r.user)||void 0===t?void 0:t.last_name),ec=(eo.length>=0||"undefined"===eo)&&"DONE"===er,eu={approve:"success",reject:"danger"},ep={approve:F("review-assignment.approve"),reject:F("review-assignment.reject")},ex={resubmit:F("code-review.resubmit-assignment"),remove:F("dashboard:modalInfo.rejected.remove-delivery")},eg={remove:"danger"},handleDownload=async(e,i)=>{try{let t=await fetch("/api/download/file?url=".concat(e,"&filename=").concat(i));if(t.ok){let e=await t.blob(),n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download=i,o.style.display="none",document.body.appendChild(o),o.click(),URL.revokeObjectURL(n),document.body.removeChild(o)}else throw Error("Error al descargar el archivo")}catch(e){(0,L.vU)("Error al descargar el archivo:",e)}},proceedToCommitFiles=async()=>{T(e=>({...e,isFetchingCommitFiles:!0})),v?k("review_code_revision"):k("file_list"),T(e=>({...e,isFetchingCommitFiles:!1}))},getAssetData=async()=>{let e=await b.Z.registry().getAsset(r.associated_slug);if(e.status<400){T(e=>({...e,isOpeningResubmitForm:!1}));let t=e.data;if(H(t),"string"==typeof(null==t?void 0:t.delivery_formats)&&!(null==t?void 0:t.delivery_formats.includes("url"))){var i;let e=await b.Z.assignments().getFile({id:r.id,academyId:null==ee?void 0:null===(i=ee.academy)||void 0===i?void 0:i.id}),t=e.data;$(t)}}},togglePopover=async()=>{T(e=>({...e,isOpeningResubmitForm:!0})),await getAssetData(),I(!G)},sendProject=async e=>{let{task:i,githubUrl:t,taskStatus:n,flags:o}=e;await ei({task:i,githubUrl:t,taskStatus:n,flags:o})};return(0,l.useEffect)(()=>{(null==r?void 0:r.id)&&Z&&$(Z)},[r,Z]),(0,l.useEffect)(()=>{p&&!ec&&P({position:"top",title:v?F("code-review.info-student"):F("code-review.info-teacher"),status:v?"info":"warning",duration:5e3})},[p,ec]),(0,n.jsx)(d.xu,{width:"100%",maxWidth:"500px",margin:"0 auto",mb:"8px",position:"relative",children:c.isFetchingCodeReviews?(0,n.jsx)(d.xu,{minHeight:"215px",children:(0,n.jsx)(U.Z,{width:"300px",height:"302px"})}):(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(s.k,{flexDirection:"column",gridGap:"16px",children:[v?(0,n.jsx)(x.Z,{size:"15px",color:z,children:es?F("dashboard:modalInfo.still-reviewing"):(0,n.jsxs)(n.Fragment,{children:[el===J&&F("code-review.assignment-approved-msg"),el===K&&F("code-review.assignment-rejected-msg")]})}):(0,n.jsxs)(s.k,{justifyContent:"space-between",children:[(0,n.jsx)(x.Z,{size:"14px",color:z,children:F("code-review.student-name",{name:ed})}),"DONE"===er&&es&&(0,n.jsx)(d.xu,{textTransform:"uppercase",fontSize:"13px",background:"yellow.light",color:"yellow.default",borderRadius:"27px",padding:"2px 6px",fontWeight:700,border:"2px solid",borderColor:"yellow.default",children:F("code-review.waiting-for-review")})]}),(ea||el===K)&&(null==r?void 0:r.description)&&(0,n.jsxs)(s.k,{background:O,flexDirection:"column",gridGap:"4px",padding:"8px 14px",borderRadius:"3px",children:[(0,n.jsx)(d.xu,{fontSize:"14px",fontWeight:700,children:F("code-review.your-teacher-said")}),(0,n.jsx)(x.Z,{display:"flex",alignContent:"center",color:z,borderRadius:"4px",width:"100%",size:"12px",children:null==r?void 0:r.description})]}),(0,n.jsxs)(s.k,{flexDirection:"column",color:z,children:[(0,n.jsx)(x.Z,{size:"md",fontWeight:700,children:v?F("dashboard:modalInfo.link-info"):F("code-review.project-delivered")}),(null==r?void 0:r.github_url)&&(0,n.jsx)(h.r,{variant:"default",fontSize:"14px",href:r.github_url,children:null==r?void 0:r.title}),(null==r?void 0:r.delivered_at)&&(0,n.jsxs)(x.Z,{size:"md",children:[F("code-review.delivered-at"),"  ",(0,B.default)(new Date(r.delivered_at),"MM/dd/yyyy")]})]}),Array.isArray(Y)&&Y.length>0&&(0,n.jsxs)(d.xu,{mt:"10px",children:[(0,n.jsx)(x.Z,{size:"l",mb:"8px",fontWeight:700,children:F("dashboard:modalInfo.files-sended")}),(0,n.jsx)(d.xu,{display:"flex",flexDirection:"column",gridGap:"8px",maxHeight:"135px",overflowY:"auto",children:Y.map(e=>{let i=e.name.split(".").pop(),t=["jpg","jpeg","png","gif","svg"].includes(i),o=V.includes(i)?i:"file",r="application/octet-stream"===e.mime;return(0,n.jsxs)(d.xu,{display:"flex",children:[(0,n.jsx)(f.Z,{icon:t?"image":r?"download":o,color:"currentColor",width:"22px",height:"22px"}),r?(0,n.jsx)(a.z,{variant:"link",onClick:()=>handleDownload(e.url,e.name),fontSize:"16px",fontWeight:"normal",height:"auto",color:"blue.500",margin:"0 0 0 10px",children:e.name}):(0,n.jsx)(h.r,{href:e.url,target:"_blank",rel:"noopener noreferrer",color:"blue.500",margin:"0 0 0 10px",children:e.name})]},"".concat(e.id,"-").concat(e.name))})})]}),(!Q||!m)&&p&&!j&&(null==en?void 0:null===(o=en.fileList)||void 0===o?void 0:o.length)>0&&(0,n.jsxs)(s.k,{padding:"8px",flexDirection:"column",gridGap:"16px",background:O,borderRadius:"4px",children:[(0,n.jsxs)(s.k,{alignItems:"center",gridGap:"10px",children:[(0,n.jsx)(f.Z,{icon:"code",width:"18.5px",height:"17px",color:"currentColor"}),(0,n.jsx)(x.Z,{size:"14px",fontWeight:700,children:F("code-review.count-code-reviews",{count:eo.length||0})}),!v&&eo.length>0&&(0,n.jsx)(a.z,{height:"auto",width:"fit-content",onClick:()=>k("review_code_revision"),isLoading:c.isFetchingCommitFiles,variant:"link",display:"flex",alignItems:"center",gridGap:"10px",justifyContent:"start",children:F("code-review.read-code-reviews")})]}),(0,n.jsxs)(a.z,{height:"auto",width:"fit-content",onClick:proceedToCommitFiles,isLoading:c.isFetchingCommitFiles,variant:"link",display:"flex",alignItems:"center",gridGap:"10px",justifyContent:"start",children:[v?F("code-review.read-and-rate-the-feedback"):F("code-review.start-code-review"),(0,n.jsx)(f.Z,{icon:"longArrowRight",width:"24px",height:"10px",color:"blue.500"})]})]}),ec&&!v&&!ea&&(0,n.jsx)(s.k,{justifyContent:"space-between",pt:"8px",children:["reject","approve"].map(e=>(0,n.jsx)(a.z,{minWidth:"128px",background:eu[e],_hover:{background:eu[e]},onClick:()=>y(e),color:"white",borderRadius:"3px",fontSize:"13px",textTransform:"uppercase",children:ep[e]},e))}),v&&el!==J&&(0,n.jsxs)(s.k,{justifyContent:"space-between",pt:"8px",children:[(0,n.jsx)(a.z,{minWidth:"128px",isLoading:c.isRemovingDelivery,background:eg.remove,_hover:{background:eg.remove},onClick:()=>{T(e=>({...e,isRemovingDelivery:!0})),et(r,X).then(()=>{R()}).finally(()=>{T(e=>({...e,isRemovingDelivery:!1}))})},color:"white",borderRadius:"3px",fontSize:"13px",textTransform:"uppercase",children:ex.remove}),(0,n.jsx)(q.Z,{isLoading:c.isOpeningResubmitForm,currentAssetData:W,currentTask:r,sendProject:sendProject,isPopoverOpen:G,closePopover:()=>{I(!1)},togglePopover:togglePopover,allowText:!0,buttonChildren:F("code-review.resubmit-assignment")})]}),!v&&ea&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.z,{minWidth:"128px",mt:"8px",onClick:()=>A(!0),color:"currentColor",borderRadius:"3px",fontSize:"13px",textTransform:"uppercase",variant:"outline",width:"fit-content",alignSelf:"center",children:F("task-handler.undo-approval")}),(0,n.jsx)(N.Z,{isOpen:E,onSuccess:()=>{R(),D()},onClose:()=>A(!1),updpateAssignment:_,currentTask:r})]})]})})})}AssignmentReview.propTypes={currentTask:r().objectOf(r().oneOfType([r().any])),loaders:r().objectOf(r().oneOfType([r().any])),hasFilesToReview:r().bool,isStudent:r().bool,noFilesToReview:r().bool,disableRate:r().bool,contextData:r().objectOf(r().oneOfType([r().any])),setStage:r().func,rejectOrApprove:r().func,updpateAssignment:r().func,onClose:r().func,resetState:r().func,setLoaders:r().func,externalFiles:r().arrayOf(r().oneOfType([r().any]))},AssignmentReview.defaultProps={currentTask:{},loaders:{},hasFilesToReview:!1,isStudent:!1,noFilesToReview:!1,disableRate:!1,contextData:{},setStage:()=>{},rejectOrApprove:()=>{},updpateAssignment:()=>{},onClose:()=>{},resetState:()=>{},setLoaders:()=>{},externalFiles:[]};var Y=t(37849);function PendingActivities(e){let{cohortSlug:i,setStage:t}=e,{t:o}=(0,u.Z)("dashboard"),{hexColor:r,featuredLight:l,fontColor:s}=(0,g.Z)(),{getMandatoryProjects:a,taskTodo:c}=(0,M.Z)(),p=a(i);return(0,n.jsxs)(d.xu,{children:[(0,n.jsxs)(d.xu,{backgroundColor:l,padding:"8px",borderRadius:"8px",border:"1px solid",borderColor:r.borderColor,children:[(0,n.jsxs)(d.xu,{mb:"5px",display:"flex",alignItems:"center",gap:"5px",children:[(0,n.jsx)(f.Z,{icon:"info",width:"14px",height:"14px",color:s}),(0,n.jsx)(j.Z,{size:"md",children:o("mandatoryProjects.title")})]}),(0,n.jsx)(x.Z,{size:"md",children:o("mandatoryProjects.description")})]}),p.map((e,o)=>(0,n.jsx)(Y.Z,{currIndex:o,data:e,taskTodo:c,showWarning:!1,cohortSlug:i,setStage:t},"".concat(e.title,"-pending-modal")))]})}PendingActivities.propTypes={cohortSlug:r().string,setStage:r().func},PendingActivities.defaultProps={cohortSlug:null,setStage:null};let $={initial:"initial",file_list:"file_list",code_review:"code_review",approve_or_reject_code_revision:"approve_or_reject_code_revision",review_code_revision:"review_code_revision",deliver_assignment:"deliver_assignment",pending_activities:"pending_activities"},{APPROVED:Q,REJECTED:ee}={PENDING:"PENDING",APPROVED:"APPROVED",REJECTED:"REJECTED"};function ReviewModal(e){var i,t,o,r,v;let{isExternal:h,externalFiles:m,isOpen:j,isStudent:w,externalData:k,defaultStage:R,fixedStage:D,onClose:T,updpateAssignment:Z,currentTask:F,cohortSlug:P,projectLink:z,disableRate:O,disableLiking:E,...A}=e,{t:G}=(0,u.Z)("assignments"),{isAuthenticated:I,isAuthenticatedWithRigobot:N,user:W}=(0,C.Z)(),{createToast:H}=(0,S.Z)({toastId:" review-status-code-revisions"}),[B,M]=(0,l.useState)(""),[U,q]=(0,l.useState)({isFetchingCommitFiles:!1,isFetchingCodeReviews:!1,isApprovingOrRejecting:!1}),[V,J]=(0,l.useState)(""),[X,K]=(0,l.useState)(""),[Y,ei]=(0,l.useState)({commitFiles:{task:{},fileList:[]},commitFile:{},code_revisions:[],my_revisions:[],revision_content:{}}),et={current:R,previous:{}},[en,eo]=(0,l.useState)(et),{hexColor:er}=(0,g.Z)(),el=null==F?void 0:F.revision_status,es=el===Q,ea=!es&&((null==Y?void 0:null===(t=Y.commitFiles)||void 0===t?void 0:null===(i=t.fileList)||void 0===i?void 0:i.length)===0||!("commitFiles"in Y)),ed=(null==Y?void 0:null===(o=Y.code_revisions)||void 0===o?void 0:o.length)>0||!w,ec=null==en?void 0:en.current,eu=es||ec===$.initial||ec===$.approve_or_reject_code_revision||ea,ep=Object.keys(en.previous).length>1,ex={approve:Q,reject:ee},eg={approve:G("code-review.why-approve"),reject:G("code-review.why-reject")},ev={approve:G("alert-message:review-assignment-approve"),reject:G("alert-message:review-assignment-reject")},setStage=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"next";eo(t=>{if("next"===i){let i={...null==t?void 0:t.previous,[null==t?void 0:t.current]:!0};return{current:e,previous:i}}if("back"===i){let e=Object.keys(t.previous),i=e[e.length-1],n=i||R,{[i]:o,...r}=t.previous;return{current:n,previous:r}}return t})},getRepoFiles=async()=>{try{if(!N||!F.github_url)return;let e=w?await b.Z.assignments().personalFiles(F.id):await b.Z.assignments().files(F.id),i=await e.json();e.ok?ei(e=>({...e,commitFiles:{task:F,fileList:i}})):ei(e=>({...e,commitFiles:{task:F,fileList:[]}}))}catch(e){(0,L.vU)("Error fetching repo files:",e)}},getCodeRevisions=async()=>{try{if(!N||!F.github_url)return;let e=w?await b.Z.assignments().getPersonalCodeRevisionsByTask(F.id):await b.Z.assignments().getCodeRevisions(F.id),i=await e.json();if(e.ok){let e=i.sort((e,i)=>new Date(i.created_at)-new Date(e.created_at));ei(t=>({...t,code_revisions:e,my_revisions:i.filter(e=>{var i;return(null==e?void 0:null===(i=e.reviewer)||void 0===i?void 0:i.username)===(null==W?void 0:W.email)})}))}}catch(e){(0,L.vU)("Error fetching code revisions:",e)}finally{q(e=>({...e,isFetchingCodeReviews:!1}))}};(0,l.useEffect)(()=>{if(j&&I&&(null==W?void 0:W.id)){let e=null==Y?void 0:Y.revision_content,i=(null==e?void 0:e.id)?{event:"review_modal_open",feedback_type:w?"read_code_review":"write_code_review",feedback_id:null==e?void 0:e.id,language:null==e?void 0:e.language,reviewer:null==e?void 0:e.reviewer,comment:null==e?void 0:e.revision_rating_comments,user_id:W.id,updated_at:null==e?void 0:e.updated_at,created_at:null==e?void 0:e.created_at}:{event:"review_modal_open",feedback_type:"project_task_review",task_id:null==F?void 0:F.id,task_slug:null==F?void 0:F.associated_slug,task_mandatory:null==F?void 0:F.mandatory,task_type:null==F?void 0:F.task_type,task_status:null==F?void 0:F.task_status,task_github_url:null==F?void 0:F.github_url,user_id:W.id};(0,y._1)({dataLayer:{...i,agent:(0,_.S7)()}})}},[j,I,Y]),(0,l.useEffect)(()=>{k&&ei(()=>({...k}))},[j,k]),(0,l.useEffect)(()=>{R&&setStage(R),j&&(null==F?void 0:F.id)>0&&!k&&(q(e=>({...e,isFetchingCodeReviews:!0})),getRepoFiles(),getCodeRevisions())},[j,null==F?void 0:F.id,k]);let handleResetFlow=()=>{ei(e=>({...e,commitFile:{}})),M("")},resetState=()=>{ei({}),setStage($.initial),eo(et),K(""),M("")},handleCommitFilesStage=()=>{w?setStage($.review_code_revision):setStage($.file_list)},proceedToCommitFiles=async()=>{q(e=>({...e,isFetchingCommitFiles:!0})),handleCommitFilesStage(),q(e=>({...e,isFetchingCommitFiles:!1}))};return(0,n.jsxs)(p.Z,{isOpen:j,onClose:()=>{T(),resetState()},title:ec===$.initial?G("code-review.assignment-review"):ec===$.approve_or_reject_code_revision?G("code-review.write-feedback"):ec===$.deliver_assignment?G("deliver-assignment.title"):ec===$.pending_activities?G("dashboard:mandatoryProjects.title"):(0,n.jsxs)(s.k,{alignItems:"center",justifyContent:"center",children:[(0,n.jsx)(f.Z,{icon:"rigobot-avatar-tiny",width:"24px",height:"24px",mr:"8px"}),G("code-review.rigobot-code-review")]}),closeOnOverlayClick:!1,maxWidth:{initial:N&&ea||!ed?"28rem":"36rem",approve_or_reject_code_revision:"36rem",file_list:"42rem",code_review:"74rem",review_code_revision:"56rem",pending_activities:"2xl"}[ec],minWidth:ec===$.code_review&&"83vw",minHeight:eu?"auto":"30rem",overflow:$.initial?"initial":"auto",margin:"0 10px",bodyStyles:{display:"flex",gridGap:"20px",padding:"1rem 1.5rem"},headerStyles:{userSelect:"none",textTransform:eu?"uppercase":"initial",fontSize:eu?"15px":"26px",textAlign:"center",fontWeight:700},closeButtonStyles:{top:eu?2:5},leftButton:ep&&(0,n.jsx)(a.z,{position:"absolute",variant:"unstyled",top:eu?2:4,left:5,onClick:()=>{setStage("","back"),handleResetFlow()},"aria-label":G("common:go-back"),children:(0,n.jsx)(f.Z,{icon:"arrowLeft2",width:"26px",height:"15px",color:er.black})}),...A,children:[ec===$.initial&&F&&(0,n.jsx)(AssignmentReview,{currentTask:F,loaders:U,hasFilesToReview:ed,isStudent:w,externalFiles:m,noFilesToReview:ea,disableRate:O,contextData:Y,setStage:setStage,rejectOrApprove:e=>{(0,y._1)({dataLayer:{event:"feedback_reject_or_approve",action_type:e,task_id:null==F?void 0:F.id,user_id:W.id,agent:(0,_.S7)()}}),setStage($.approve_or_reject_code_revision),K(e)},updpateAssignment:Z,onClose:T,resetState:resetState,setLoaders:q}),ec===$.approve_or_reject_code_revision&&(0,n.jsxs)(s.k,{flexDirection:"column",maxWidth:"500px",margin:"0 auto",gridGap:"15px",width:"100%",children:[(0,n.jsxs)(d.xu,{position:"relative",children:[(0,n.jsx)(x.Z,{fontSize:"14px",fontWeight:700,mb:"18px",children:eg[X]}),(0,n.jsx)(c.g,{"aria-label":"feedback input",fontSize:"12px",onChange:e=>{J(e.target.value)},minHeight:"134",placeholder:G("code-review.start-review-here")}),(0,n.jsx)(d.xu,{position:"absolute",bottom:1.5,right:3,color:V.length<10?"#EB5757":"currentColor",children:"".concat(V.length," / ").concat(450)})]}),(0,n.jsx)(a.z,{onClick:()=>{(0,y._1)({dataLayer:{event:"feedback_action",comment:V,action_type:X,task_id:null==F?void 0:F.id,user_id:W.id,agent:(0,_.S7)()}}),void 0!==ex[X]&&(q(e=>({...e,isApprovingOrRejecting:!0})),b.Z.assignments().updateTask({id:F.id,revision_status:ex[X],description:V}).then(()=>{H({position:"top",title:ev[X],status:"success",duration:5e3,isClosable:!0}),Z({...F,id:F.id,revision_status:ex[X],description:V}),resetState(),T()}).catch(()=>{H({position:"top",title:G("alert-message:review-assignment-error"),status:"error",duration:5e3,isClosable:!0})}).finally(()=>{q(e=>({...e,isApprovingOrRejecting:!1}))}))},isLoading:U.isApprovingOrRejecting,variant:"default",alignSelf:"flex-end",isDisabled:V.length<10||void 0===ex[X],children:G("code-review.send-feedback")})]}),ec===$.file_list&&!U.isFetchingCommitFiles&&(0,n.jsx)(FileList,{isStudent:w,contextData:Y,setContextData:ei,currentTask:F,updpateAssignment:Z,stage:ec,stages:$,setStage:setStage,setReviewStatus:K}),ec===$.code_review&&((null===(r=Y.commitFile)||void 0===r?void 0:r.code)||(null===(v=Y.revision_content)||void 0===v?void 0:v.code))&&(0,n.jsx)(CodeReview,{isExternal:h,onClose:T,disableRate:O,isStudent:w,setStage:setStage,handleResetFlow:handleResetFlow,contextData:Y,setContextData:ei,selectedText:B,handleSelectedText:()=>{let e=window.getSelection().toString();e.length>0&&M(e)}}),ec===$.review_code_revision&&(0,n.jsx)(ReviewCodeRevision,{disableRate:E,contextData:Y,setContextData:ei,stage:ec,stages:$,setStage:setStage}),ec===$.deliver_assignment&&(0,n.jsx)(DeliverModalContent,{onClose:T,isStudent:w,contextData:Y,currentTask:F,projectLink:z,updpateAssignment:Z,setStage:setStage,showCodeReviews:(!N||!ea)&&ed&&!O,loaders:U,proceedToCommitFiles:proceedToCommitFiles,...A}),ec===$.pending_activities&&(0,n.jsx)(PendingActivities,{cohortSlug:P,setStage:setStage})]})}ReviewModal.propTypes={isOpen:r().bool,onClose:r().func,currentTask:r().objectOf(r().oneOfType([r().any])),projectLink:r().string,defaultStage:r().string,updpateAssignment:r().func,externalData:r().objectOf(r().oneOfType([r().any])),isStudent:r().bool,fixedStage:r().bool,disableRate:r().bool,disableLiking:r().bool,isExternal:r().bool,cohortSlug:r().string},ReviewModal.defaultProps={isOpen:!1,onClose:()=>{},currentTask:{},projectLink:"",defaultStage:$.initial,updpateAssignment:()=>{},externalData:null,isStudent:!1,fixedStage:!1,disableRate:!1,disableLiking:!1,isExternal:!1,cohortSlug:null};var ei=ReviewModal},37849:function(e,i,t){var n=t(50265),o=t(18964),r=t(49e3),l=t(30793),s=t(15412),a=t(38256),d=t.n(a),c=t(26363),u=t(26189),p=t(87488),x=t(53862),g=t(19016),v=t(66585),h=t(96180),m=t(5594);function SyllabusActivity(e){var i,t,a,d;let{data:f,currIndex:b,isDisabled:j,onDisabledClick:w,variant:k,showWarning:y,cohortSlug:_,setStage:C}=e,{t:S,lang:R}=(0,s.Z)("dashboard"),{taskTodo:D,state:T,updateAssignment:Z}=(0,u.Z)(),{cohortSession:F,cohortsAssignments:P}=T,[z,O]=(0,c.useState)(!1),{hexColor:E}=(0,p.Z)(),A=f.slug||"",G=_?null===(i=P[_])||void 0===i?void 0:i.tasks:D,I=(null==G?void 0:G.length)>0?G.find(e=>(null==e?void 0:e.task_type)===(null==f?void 0:f.task_type)&&e.associated_slug===A):{},L=null==f?void 0:f.task_type.toLowerCase(),{type:N,title:W,icon:H,target:B,url:M}=f,{socials:U,shareLink:q}=(0,x.Z)({info:I,shareMessage:S("dashboard:share-message",{title:null==I?void 0:I.title})}),sendProject=async e=>{let{task:i,githubUrl:t,taskStatus:n,flags:o}=e;await Z({task:i,githubUrl:t,taskStatus:n,flags:o}),O(!0)},V=(null==I?void 0:I.task_status)==="DONE"||(null==I?void 0:I.revision_status)==="APPROVED",J=y&&(null==f?void 0:f.task_type)==="PROJECT"&&!V&&(null==f?void 0:f.mandatory)===!0&&(null==f?void 0:f.daysDiff)>=14,X={lesson:S("modules.read"),exercise:S("modules.start"),project:S("modules.start"),quiz:S("modules.answer")},K="en"===R?(null==f?void 0:null===(t=f.translations)||void 0===t?void 0:t.en)||(null==f?void 0:null===(a=f.translations)||void 0===a?void 0:a.us):(null==f?void 0:null===(d=f.translations)||void 0===d?void 0:d[R])||{},Y="".concat("en"!==R?"/".concat(R):"","/syllabus/").concat(_||(null==F?void 0:F.slug),"/").concat(f.type.toLowerCase(),"/").concat((null==K?void 0:K.slug)||(null==I?void 0:I.associated_slug)),$=j?"#disabled":_?"/main-cohort/".concat(null==F?void 0:F.slug).concat(Y):Y,Q={"open-only":{rightItemHandler:(0,n.jsxs)(o.r,{href:$,color:E.blueDefault,children:[S("common:open"),"  ",f.type]})}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(v.Z,{mandatory:J,currIndex:b,textWithLink:!0,link:$,isDone:V,onDisabledClick:w,leftContentStyle:j?{textDecoration:"none"}:{},data:{type:N,title:(null==K?void 0:K.title)||W,icon:H,target:B,url:M},rightItemHandler:j?(0,n.jsxs)(r.z,{variant:"link",gridGap:"4px",onClick:()=>w({...f,title:(null==K?void 0:K.title)||W}),children:[(0,n.jsx)(m.Z,{icon:"padlock",width:"20px",height:"20px"}),(0,n.jsx)(l.xu,{as:"span",display:{base:"none",sm:"initial"},children:"".concat(null==X?void 0:X[L]," ").concat(S("common:".concat(L)).toLocaleLowerCase())})]}):(0,n.jsx)(g.Z,{currentTask:I,sendProject:sendProject,setStage:C}),...Q[k]}),(null==I?void 0:I.task_status)==="DONE"&&z&&(0,n.jsx)(h.Z,{variant:"outline",title:S("projects:share-certificate.title"),shareText:S("projects:share-certificate.share-via",{project:null==I?void 0:I.title}),link:q,socials:U,currentTask:I,onlyModal:!0,withParty:!0})]})}SyllabusActivity.propTypes={data:d().objectOf(d().oneOfType([d().any])),currIndex:d().number,isDisabled:d().bool,onDisabledClick:d().func,variant:d().string,showWarning:d().bool,cohortSlug:d().string,setStage:d().func},SyllabusActivity.defaultProps={data:{},currIndex:0,isDisabled:!1,onDisabledClick:()=>{},variant:"default",showWarning:!0,cohortSlug:null,setStage:null},i.Z=(0,c.memo)(SyllabusActivity)},66585:function(e,i,t){var n=t(50265),o=t(75434),r=t(42166),l=t(59979),s=t(30793),a=t(18964),d=t(91176),c=t(66468),u=t(38256),p=t.n(u),x=t(26363),g=t(15412),v=t(24143),h=t(5594),m=t(28849),f=t(58653);function TaskBar(e){let{onClickHandler:i,data:t,containerStyle:u,leftContentStyle:p,containerPX:b,width:j,currIndex:w,isDone:k,rightItemHandler:y,link:_,textWithLink:C,mandatory:S,onDisabledClick:R}=e,{t:D,lang:T}=(0,g.Z)("dashboard"),Z=k?(0,o.ff)("featuredLight","featuredDark"):(0,o.ff)("white","primary"),F=(0,o.ff)("gray.600","gray.200"),[P,z]=(0,x.useState)(!1);return(0,n.jsxs)(r.K,{width:j,style:u,gridGap:"12px",direction:"row",backgroundColor:Z,border:S?"2px solid":"".concat((0,o.ff)("1px","2px")," solid"),borderColor:S?"yellow.default":k?"transparent":(0,o.ff)("gray.350","gray.700"),height:"auto",py:"10px",px:b||"15px",my:"10px",rounded:"2xl",overflow:"hidden",_hover:{bg:(0,o.ff)("blue.light","featuredDark")},children:[(0,n.jsx)(m.default,{isOpen:P,onClose:()=>z(!1),title:D("modules.target-blank-title"),isReadonly:!0,description:D("modules.target-blank-msg",{title:t.title}),link:(0,f.NM)(t.url,{lang:T}),handlerText:D("common:open"),closeText:D("common:close"),closeButtonVariant:"outline",actionHandler:()=>{void 0!==window&&(z(!1),window.open(t.url,"_blank"))}}),(0,n.jsxs)(l.k,{width:"100%",alignItems:"center",children:[null!==w&&(0,n.jsx)(n.Fragment,{children:S?(0,n.jsx)(h.Z,{icon:"warning",color:"yellow.default",width:"28px",height:"28px",style:{marginRight:"15px"}}):(0,n.jsx)(s.xu,{width:"30px",minWidth:"30px",alignSelf:"center",mr:"15px",display:"flex",justifyContent:"center",alignItems:"center",height:"30px",rounded:"full",align:"center",background:k?"blue.default":"#BFBFBF",children:(0,n.jsx)(v.Z,{fontWeight:"bold",margin:"0",size:"sm",color:"#FFFFFF",children:w+1})})}),t.icon&&(0,n.jsx)(s.xu,{display:{base:"none",sm:"flex"},mr:"20px",ml:"20px",minWidth:"22px",width:"22px",children:(0,n.jsx)(h.Z,{icon:t.icon||"book",color:k?"#0084FF":"#A4A4A4"})}),!1,C?(0,n.jsxs)(a.r,{href:"blank"===t.target?"#_blank":_,onClick:e=>{R(),"blank"===t.target&&(e.preventDefault(),e.stopPropagation(),z(!0))},style:p,width:"auto",children:[t.type&&(0,n.jsx)(d.X,{as:"h3",fontSize:"13px",color:F,lineHeight:"18px",letterSpacing:"0.05em",margin:"0",isTruncated:!0,fontWeight:"900",textTransform:"uppercase",children:t.type}),(0,n.jsx)(v.Z,{size:"l",fontWeight:"normal",color:F,lineHeight:"18px",letterSpacing:"0.05em",margin:"0",children:t.title})]}):(0,n.jsxs)(l.k,{cursor:"pointer",onClick:i,flexDirection:"column",style:p,justifyContent:"center",children:[t.type&&(0,n.jsx)(d.X,{as:"h3",fontSize:"13px",color:F,lineHeight:"18px",letterSpacing:"0.05em",margin:"0",isTruncated:!0,fontWeight:"900",textTransform:"uppercase",children:t.type}),(0,n.jsx)(v.Z,{size:"l",fontWeight:"normal",color:F,lineHeight:"18px",letterSpacing:"0.05em",margin:"0",children:t.title})]})]}),(0,n.jsx)(c.U,{flexShrink:0,width:"auto",style:{margin:0},children:y})]},"".concat(t.title,"-").concat(w))}TaskBar.propTypes={onClickHandler:p().func,data:p().objectOf(p().oneOfType([p().any])),containerStyle:p().objectOf(p().oneOfType([p().any])),leftContentStyle:p().objectOf(p().oneOfType([p().any])),containerPX:p().string,width:p().string,link:p().string,textWithLink:p().bool,rightItemHandler:p().element,isDone:p().bool,currIndex:p().number,mandatory:p().bool,onDisabledClick:p().func},TaskBar.defaultProps={onClickHandler:()=>{},data:{},containerStyle:{},leftContentStyle:{},containerPX:"",width:"100%",link:"",textWithLink:!1,rightItemHandler:null,isDone:!1,currIndex:null,mandatory:!1,onDisabledClick:()=>{}},i.Z=TaskBar},91112:function(e,i,t){var n=t(50265),o=t(75434),r=t(11055),l=t(83268),s=t(8573),a=t(4775),d=t(29059),c=t(91810),u=t(89896),p=t(49e3),x=t(38256),g=t.n(x),v=t(15412),h=t(26363),m=t(87488),f=t(24143),b=t(12509),j=t(9269);function UndoApprovalModal(e){var i,t;let{isOpen:x,currentTask:g,onSuccess:w,onClose:k,updpateAssignment:y}=e,{modal:_,borderColor2:C}=(0,m.Z)(),[S,R]=(0,h.useState)(!1),D=(0,o.ff)("gray.600","gray.200"),{t:T}=(0,v.Z)("assignments"),{createToast:Z}=(0,j.Z)({toastId:" review-assignment-updated-and-error"}),F="".concat(null==g?void 0:null===(i=g.user)||void 0===i?void 0:i.first_name," ").concat(null==g?void 0:null===(t=g.user)||void 0===t?void 0:t.last_name),P=(null==g?void 0:g.revision_status)==="IGNORED";return(0,n.jsxs)(r.u_,{isOpen:x,onClose:k,size:"lg",children:[(0,n.jsx)(l.Z,{}),(0,n.jsxs)(s.h,{background:_.background2,borderRadius:"md",marginTop:"10%",children:[(0,n.jsx)(a.x,{fontSize:"15px",color:D,textAlign:"center",letterSpacing:"0.05em",borderBottom:"1px solid",borderColor:C,fontWeight:"bold",textTransform:"uppercase",children:T("deliver-assignment.title")}),(0,n.jsx)(d.o,{}),(0,n.jsx)(c.f,{pt:"2rem",pb:"2rem",px:{base:"20px",md:"15%"},children:(0,n.jsx)(f.Z,{fontSize:"22px",fontWeight:"700",textAlign:"center",children:T("task-handler.confirm-undo",{student:F})})}),(0,n.jsx)(u.m,{margin:"0 1.5rem",padding:"1.5rem 0",justifyContent:"center",borderTop:"1px solid",borderColor:C,children:(0,n.jsx)(p.z,{isLoading:S,onClick:()=>{R(!0),b.Z.assignments().updateTask({id:g.id,revision_status:"PENDING",description:""}).then(()=>{y({...g,id:g.id,revision_status:"PENDING",description:""}),w(),k(),Z({position:"top",title:T("alert-message:review-assignment-updated"),status:"success",duration:5e3,isClosable:!0})}).catch(e=>{console.log(e),Z({position:"top",title:T("alert-message:review-assignment-error"),status:"error",duration:5e3,isClosable:!0})}).finally(()=>R(!1))},variant:P?"default":"outline",textTransform:"uppercase",children:T("task-handler.undo-approval")})})]})]})}UndoApprovalModal.propTypes={isOpen:g().bool.isRequired,onClose:g().func.isRequired,currentTask:g().objectOf(g().oneOfType([g().any])).isRequired,updpateAssignment:g().func.isRequired,onSuccess:g().func},UndoApprovalModal.defaultProps={onSuccess:()=>{}},i.Z=UndoApprovalModal}}]);